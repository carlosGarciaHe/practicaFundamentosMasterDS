<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 ANÁLISIS EXPLORATORIO VARIABLES | Banco</title>
  <meta name="description" content="2 ANÁLISIS EXPLORATORIO VARIABLES | Banco" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2 ANÁLISIS EXPLORATORIO VARIABLES | Banco" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 ANÁLISIS EXPLORATORIO VARIABLES | Banco" />
  
  
  

<meta name="author" content="Carlos, Alberto y Juan Ramón" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introducción-y-objetivos.html"/>
<link rel="next" href="etl.html"/>
<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="book_assets/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="book_assets/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introducción-y-objetivos.html"><a href="introducción-y-objetivos.html"><i class="fa fa-check"></i><b>1</b> Introducción y objetivos</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción-y-objetivos.html"><a href="introducción-y-objetivos.html#introducción"><i class="fa fa-check"></i><b>1.1</b> Introducción</a></li>
<li class="chapter" data-level="1.2" data-path="introducción-y-objetivos.html"><a href="introducción-y-objetivos.html#objetivos"><i class="fa fa-check"></i><b>1.2</b> Objetivos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html"><i class="fa fa-check"></i><b>2</b> ANÁLISIS EXPLORATORIO VARIABLES</a><ul>
<li class="chapter" data-level="2.1" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#importación-dataset"><i class="fa fa-check"></i><b>2.1</b> Importación dataset</a></li>
<li class="chapter" data-level="2.2" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#división-en-train-y-test"><i class="fa fa-check"></i><b>2.2</b> División en train y test</a></li>
<li class="chapter" data-level="2.3" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#estructura-y-resumen-de-train"><i class="fa fa-check"></i><b>2.3</b> Estructura y resumen de train</a></li>
<li class="chapter" data-level="2.4" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#exploratorio-univariante-de-las-variables-predictoras"><i class="fa fa-check"></i><b>2.4</b> Exploratorio univariante de las variables predictoras</a><ul>
<li class="chapter" data-level="2.4.1" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-age"><i class="fa fa-check"></i><b>2.4.1</b> Variable age</a></li>
<li class="chapter" data-level="2.4.2" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-balance"><i class="fa fa-check"></i><b>2.4.2</b> Variable balance</a></li>
<li class="chapter" data-level="2.4.3" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-job"><i class="fa fa-check"></i><b>2.4.3</b> Variable job</a></li>
<li class="chapter" data-level="2.4.4" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-marital"><i class="fa fa-check"></i><b>2.4.4</b> Variable marital</a></li>
<li class="chapter" data-level="2.4.5" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-education"><i class="fa fa-check"></i><b>2.4.5</b> Variable education</a></li>
<li class="chapter" data-level="2.4.6" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-default"><i class="fa fa-check"></i><b>2.4.6</b> Variable default</a></li>
<li class="chapter" data-level="2.4.7" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-housing"><i class="fa fa-check"></i><b>2.4.7</b> Variable housing</a></li>
<li class="chapter" data-level="2.4.8" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-loan"><i class="fa fa-check"></i><b>2.4.8</b> Variable loan</a></li>
<li class="chapter" data-level="2.4.9" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-contact"><i class="fa fa-check"></i><b>2.4.9</b> Variable contact</a></li>
<li class="chapter" data-level="2.4.10" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-mes"><i class="fa fa-check"></i><b>2.4.10</b> Variable mes</a></li>
<li class="chapter" data-level="2.4.11" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-day"><i class="fa fa-check"></i><b>2.4.11</b> Variable day</a></li>
<li class="chapter" data-level="2.4.12" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-duration"><i class="fa fa-check"></i><b>2.4.12</b> Variable duration</a></li>
<li class="chapter" data-level="2.4.13" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-campaign"><i class="fa fa-check"></i><b>2.4.13</b> Variable campaign</a></li>
<li class="chapter" data-level="2.4.14" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-pdays"><i class="fa fa-check"></i><b>2.4.14</b> Variable pdays</a></li>
<li class="chapter" data-level="2.4.15" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-poutcome"><i class="fa fa-check"></i><b>2.4.15</b> Variable poutcome</a></li>
<li class="chapter" data-level="2.4.16" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-previous"><i class="fa fa-check"></i><b>2.4.16</b> Variable previous</a></li>
<li class="chapter" data-level="2.4.17" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#variable-term_deposit-objetivo"><i class="fa fa-check"></i><b>2.4.17</b> Variable term_deposit (Objetivo)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="análisis-exploratorio-variables.html"><a href="análisis-exploratorio-variables.html#exploratorio-multivariante"><i class="fa fa-check"></i><b>2.5</b> Exploratorio multivariante</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="etl.html"><a href="etl.html"><i class="fa fa-check"></i><b>3</b> ETL</a><ul>
<li class="chapter" data-level="3.1" data-path="etl.html"><a href="etl.html#tratamiento-de-datos-faltantes"><i class="fa fa-check"></i><b>3.1</b> Tratamiento de datos faltantes</a></li>
<li class="chapter" data-level="3.2" data-path="etl.html"><a href="etl.html#transformación-de-variables"><i class="fa fa-check"></i><b>3.2</b> Transformación de variables</a><ul>
<li class="chapter" data-level="3.2.1" data-path="etl.html"><a href="etl.html#train-poutcome"><i class="fa fa-check"></i><b>3.2.1</b> Train poutcome</a></li>
<li class="chapter" data-level="3.2.2" data-path="etl.html"><a href="etl.html#variable-previous-1"><i class="fa fa-check"></i><b>3.2.2</b> Variable previous</a></li>
<li class="chapter" data-level="3.2.3" data-path="etl.html"><a href="etl.html#variable-pdays-1"><i class="fa fa-check"></i><b>3.2.3</b> Variable pdays</a></li>
<li class="chapter" data-level="3.2.4" data-path="etl.html"><a href="etl.html#variable-campaign-1"><i class="fa fa-check"></i><b>3.2.4</b> Variable campaign</a></li>
<li class="chapter" data-level="3.2.5" data-path="etl.html"><a href="etl.html#variable-duration-1"><i class="fa fa-check"></i><b>3.2.5</b> Variable duration</a></li>
<li class="chapter" data-level="3.2.6" data-path="etl.html"><a href="etl.html#variable-month"><i class="fa fa-check"></i><b>3.2.6</b> Variable month</a></li>
<li class="chapter" data-level="3.2.7" data-path="etl.html"><a href="etl.html#variable-contact-1"><i class="fa fa-check"></i><b>3.2.7</b> Variable contact</a></li>
<li class="chapter" data-level="3.2.8" data-path="etl.html"><a href="etl.html#variable-balance-1"><i class="fa fa-check"></i><b>3.2.8</b> Variable balance</a></li>
<li class="chapter" data-level="3.2.9" data-path="etl.html"><a href="etl.html#variable-age-1"><i class="fa fa-check"></i><b>3.2.9</b> Variable age</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="etl.html"><a href="etl.html#selección-de-variables"><i class="fa fa-check"></i><b>3.3</b> Selección de variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelado.html"><a href="modelado.html"><i class="fa fa-check"></i><b>4</b> Modelado</a></li>
<li class="chapter" data-level="5" data-path="evaluación.html"><a href="evaluación.html"><i class="fa fa-check"></i><b>5</b> Evaluación</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Banco</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="análisis-exploratorio-variables" class="section level1">
<h1><span class="header-section-number">2</span> ANÁLISIS EXPLORATORIO VARIABLES</h1>
<p>En el EDA de este proyecto se ha procedido a analizar cada variable individualmente. Se ha observado cada una de las variables por si sola, que representan, su distribución, estadísticos básicos, missing values y capacidad predictora en un enfoque univariante para un modelo de regresión logística. Todo ello para entender cada una de las variables y el como procesarlas de la mejor forma posible de cara a utilizarlas en un modelo de aprendizaje automático. Por ello, también se ha adelantado en esta fase algunas posibles transformaciones que puedan ser de utilidad en la ETL.</p>
<div id="importación-dataset" class="section level2">
<h2><span class="header-section-number">2.1</span> Importación dataset</h2>
<p>Fijamos semilla para asegurar la replicación de los resultados de este proyecto.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="análisis-exploratorio-variables.html#cb1-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="análisis-exploratorio-variables.html#cb2-1"></a>data =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;BankCustomerdata.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## -- Column specification --------------------------------------------------------
## cols(
##   age = col_double(),
##   job = col_character(),
##   marital = col_character(),
##   education = col_character(),
##   default = col_character(),
##   balance = col_double(),
##   housing = col_character(),
##   loan = col_character(),
##   contact = col_character(),
##   day = col_double(),
##   month = col_character(),
##   duration = col_double(),
##   campaign = col_double(),
##   pdays = col_double(),
##   previous = col_double(),
##   poutcome = col_character(),
##   term_deposit = col_character()
## )</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="análisis-exploratorio-variables.html#cb4-1"></a><span class="kw">nrow</span>(data)</span></code></pre></div>
<pre><code>## [1] 42639</code></pre>
</div>
<div id="división-en-train-y-test" class="section level2">
<h2><span class="header-section-number">2.2</span> División en train y test</h2>
<p>Dividimos el dataset original en el conjunto de <strong>train</strong> y <strong>test</strong>. Test se ha apartado hasta evaluación, tomando las decisiones de la ETL solo con train para evitar cualquier tipo de sobreajuste indirecto sobre este subconjunto.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="análisis-exploratorio-variables.html#cb6-1"></a>n =<span class="st"> </span><span class="kw">nrow</span>(data)</span>
<span id="cb6-2"><a href="análisis-exploratorio-variables.html#cb6-2"></a>trainIndex =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> <span class="kw">round</span>(<span class="fl">0.8</span><span class="op">*</span>n), <span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb6-3"><a href="análisis-exploratorio-variables.html#cb6-3"></a>train =<span class="st"> </span>data[trainIndex ,]</span>
<span id="cb6-4"><a href="análisis-exploratorio-variables.html#cb6-4"></a>test =<span class="st"> </span>data[<span class="op">-</span>trainIndex ,]</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="análisis-exploratorio-variables.html#cb7-1"></a><span class="kw">nrow</span>(train)</span></code></pre></div>
<pre><code>## [1] 34111</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="análisis-exploratorio-variables.html#cb9-1"></a><span class="kw">nrow</span>(test)</span></code></pre></div>
<pre><code>## [1] 8528</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="análisis-exploratorio-variables.html#cb11-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>term_deposit)</span></code></pre></div>
<pre><code>##     no   yes
##             
##  30938  3173</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="análisis-exploratorio-variables.html#cb13-1"></a><span class="kw">ftable</span>(test<span class="op">$</span>term_deposit)</span></code></pre></div>
<pre><code>##    no  yes
##           
##  7740  788</code></pre>
</div>
<div id="estructura-y-resumen-de-train" class="section level2">
<h2><span class="header-section-number">2.3</span> Estructura y resumen de train</h2>
<p>Observamos su estructura y un resumen de las principales variables</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="análisis-exploratorio-variables.html#cb15-1"></a><span class="kw">summary</span>(train)</span></code></pre></div>
<pre><code>##       age            job              marital           education        
##  Min.   :18.00   Length:34111       Length:34111       Length:34111      
##  1st Qu.:33.00   Class :character   Class :character   Class :character  
##  Median :39.00   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :40.79                                                           
##  3rd Qu.:48.00                                                           
##  Max.   :95.00                                                           
##    default             balance           housing              loan          
##  Length:34111       Min.   : -8019.0   Length:34111       Length:34111      
##  Class :character   1st Qu.:    63.5   Class :character   Class :character  
##  Mode  :character   Median :   432.0   Mode  :character   Mode  :character  
##                     Mean   :  1345.1                                        
##                     3rd Qu.:  1392.5                                        
##                     Max.   :102127.0                                        
##    contact               day           month              duration     
##  Length:34111       Min.   : 1.00   Length:34111       Min.   :   0.0  
##  Class :character   1st Qu.: 8.00   Class :character   1st Qu.: 100.0  
##  Mode  :character   Median :16.00   Mode  :character   Median : 176.0  
##                     Mean   :15.84                      Mean   : 255.6  
##                     3rd Qu.:21.00                      3rd Qu.: 315.0  
##                     Max.   :31.00                      Max.   :4918.0  
##     campaign         pdays          previous          poutcome        
##  Min.   : 1.00   Min.   : -1.0   Min.   :  0.0000   Length:34111      
##  1st Qu.: 1.00   1st Qu.: -1.0   1st Qu.:  0.0000   Class :character  
##  Median : 2.00   Median : -1.0   Median :  0.0000   Mode  :character  
##  Mean   : 2.81   Mean   : 34.1   Mean   :  0.4633                     
##  3rd Qu.: 3.00   3rd Qu.: -1.0   3rd Qu.:  0.0000                     
##  Max.   :63.00   Max.   :536.0   Max.   :275.0000                     
##  term_deposit      
##  Length:34111      
##  Class :character  
##  Mode  :character  
##                    
##                    
## </code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="análisis-exploratorio-variables.html#cb17-1"></a><span class="kw">describe</span>(train)</span></code></pre></div>
<pre><code>## train 
## 
##  17  Variables      34111  Observations
## --------------------------------------------------------------------------------
## age 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       74    0.999    40.79    11.47       27       29 
##      .25      .50      .75      .90      .95 
##       33       39       48       56       58 
## 
## lowest : 18 19 20 21 22, highest: 87 89 90 92 95
## --------------------------------------------------------------------------------
## job 
##        n  missing distinct 
##    34111        0       12 
## 
## lowest : admin.       blue-collar  entrepreneur housemaid    management  
## highest: services     student      technician   unemployed   unknown     
## 
## admin. (3892, 0.114), blue-collar (7608, 0.223), entrepreneur (1137, 0.033),
## housemaid (937, 0.027), management (7130, 0.209), retired (1503, 0.044),
## self-employed (1183, 0.035), services (3215, 0.094), student (581, 0.017),
## technician (5763, 0.169), unemployed (955, 0.028), unknown (207, 0.006)
## --------------------------------------------------------------------------------
## marital 
##        n  missing distinct 
##    34111        0        3 
##                                      
## Value      divorced  married   single
## Frequency      3982    20680     9449
## Proportion    0.117    0.606    0.277
## --------------------------------------------------------------------------------
## education 
##        n  missing distinct 
##    34111        0        4 
##                                                   
## Value        primary secondary  tertiary   unknown
## Frequency       5272     17645      9847      1347
## Proportion     0.155     0.517     0.289     0.039
## --------------------------------------------------------------------------------
## default 
##        n  missing distinct 
##    34111        0        2 
##                       
## Value         no   yes
## Frequency  33463   648
## Proportion 0.981 0.019
## --------------------------------------------------------------------------------
## balance 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0     6531    0.999     1345     2045   -191.0      0.0 
##      .25      .50      .75      .90      .95 
##     63.5    432.0   1392.5   3570.0   5771.0 
## 
## lowest :  -8019  -6847  -4057  -3372  -3313, highest:  64343  66721  71188  81204 102127
## --------------------------------------------------------------------------------
## housing 
##        n  missing distinct 
##    34111        0        2 
##                       
## Value         no   yes
## Frequency  14509 19602
## Proportion 0.425 0.575
## --------------------------------------------------------------------------------
## loan 
##        n  missing distinct 
##    34111        0        2 
##                       
## Value         no   yes
## Frequency  28463  5648
## Proportion 0.834 0.166
## --------------------------------------------------------------------------------
## contact 
##        n  missing distinct 
##    34111        0        3 
##                                         
## Value       cellular telephone   unknown
## Frequency      21769      2097     10245
## Proportion     0.638     0.061     0.300
## --------------------------------------------------------------------------------
## day 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       31    0.998    15.84    9.544        3        5 
##      .25      .50      .75      .90      .95 
##        8       16       21       28       30 
## 
## lowest :  1  2  3  4  5, highest: 27 28 29 30 31
## --------------------------------------------------------------------------------
## month 
##        n  missing distinct 
##    34111        0       12 
## 
## lowest : apr aug dec feb jan, highest: mar may nov oct sep
##                                                                             
## Value        apr   aug   dec   feb   jan   jul   jun   mar   may   nov   oct
## Frequency   2142  4813   171  1823   969  5244  4125   214 10852  3113   419
## Proportion 0.063 0.141 0.005 0.053 0.028 0.154 0.121 0.006 0.318 0.091 0.012
##                 
## Value        sep
## Frequency    226
## Proportion 0.007
## --------------------------------------------------------------------------------
## duration 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0     1485        1    255.6      235       35       58 
##      .25      .50      .75      .90      .95 
##      100      176      315      544      749 
## 
## lowest :    0    2    3    4    5, highest: 3284 3322 3366 3881 4918
## --------------------------------------------------------------------------------
## campaign 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       45    0.921     2.81    2.435        1        1 
##      .25      .50      .75      .90      .95 
##        1        2        3        5        8 
## 
## lowest :  1  2  3  4  5, highest: 43 44 55 58 63
## --------------------------------------------------------------------------------
## pdays 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0      409    0.393     34.1    62.25       -1       -1 
##      .25      .50      .75      .90      .95 
##       -1       -1       -1      175      301 
## 
## lowest :  -1   1   2   4   5, highest: 495 515 518 520 536
## --------------------------------------------------------------------------------
## previous 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       36    0.393   0.4633   0.8488        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        0        1        3 
## 
## lowest :   0   1   2   3   4, highest:  37  38  51  58 275
## --------------------------------------------------------------------------------
## poutcome 
##        n  missing distinct 
##    34111        0        4 
##                                           
## Value      failure   other success unknown
## Frequency     3401    1201     625   28884
## Proportion   0.100   0.035   0.018   0.847
## --------------------------------------------------------------------------------
## term_deposit 
##        n  missing distinct 
##    34111        0        2 
##                       
## Value         no   yes
## Frequency  30938  3173
## Proportion 0.907 0.093
## --------------------------------------------------------------------------------</code></pre>
</div>
<div id="exploratorio-univariante-de-las-variables-predictoras" class="section level2">
<h2><span class="header-section-number">2.4</span> Exploratorio univariante de las variables predictoras</h2>
<div id="variable-age" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Variable age</h3>
<p>La variable age es una variable cuantitativa situada en la escala de proporción. Dicha variable indica la edad del cliente.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="análisis-exploratorio-variables.html#cb19-1"></a><span class="kw">describe</span>(train<span class="op">$</span>age)</span></code></pre></div>
<pre><code>## train$age 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       74    0.999    40.79    11.47       27       29 
##      .25      .50      .75      .90      .95 
##       33       39       48       56       58 
## 
## lowest : 18 19 20 21 22, highest: 87 89 90 92 95</code></pre>
<p>Debes ser mayor de edad para contratar el depósito.
La media de edad de nuestros individuos se encuentra en torno a los 41 años.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="análisis-exploratorio-variables.html#cb21-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span></span>
<span id="cb21-2"><a href="análisis-exploratorio-variables.html#cb21-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb21-3"><a href="análisis-exploratorio-variables.html#cb21-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Edad del cliente&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="análisis-exploratorio-variables.html#cb23-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Edad del cliente&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="análisis-exploratorio-variables.html#cb25-1"></a><span class="kw">ggplot</span>(train ,<span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Edad del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
<p>Podemos observar como son los jóvenes y los mayores los que mayor probabilidad de contratar el depósito tienen.</p>
<p>Se realiza un logit con la variable edad en forma continua para ver sus resultados.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="análisis-exploratorio-variables.html#cb26-1"></a>logit_edad =<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>age, <span class="dt">family=</span>(<span class="kw">binomial</span>(<span class="dt">link=</span>logit)), <span class="dt">data =</span> train)</span>
<span id="cb26-2"><a href="análisis-exploratorio-variables.html#cb26-2"></a><span class="kw">summary</span>(logit_edad)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ age, family = (binomial(link = logit)), 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4859  -0.4466  -0.4396  -0.4342   2.2147  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.429109   0.076792 -31.632   &lt;2e-16 ***
## age          0.003707   0.001812   2.046   0.0408 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 21108  on 34109  degrees of freedom
## AIC: 21112
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Se comprueba como la variable edad en forma continua no es tan significativa ya que el peso de los ancianos se contrarresta con el peso de los jóvenes. Por ello aumentar la variable edad en una unidad no tiene un efecto tan significativo en nuestra variable objetivo.</p>
<p>Se puede apreciar gráficamente como los más jóvenes y los más mayores tienen mayor probabilidad de contratar el depósito. Queremos ver si estas particularidades tienen efecto que con en una variable continua se podrían obviar.</p>
<p>Para ello convertimos nuestra variable continua en una variable categórica.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="análisis-exploratorio-variables.html#cb28-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">age_categorica =</span> <span class="kw">cut</span>(age, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">29</span>, <span class="dv">44</span>, <span class="dv">59</span>, <span class="dv">100</span>), <span class="dt">right =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Joven&#39;</span>,<span class="st">&#39;MedianaEdad&#39;</span>,<span class="st">&#39;Mayores&#39;</span>,<span class="st">&#39;Ancianos&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="análisis-exploratorio-variables.html#cb29-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>age_categorica)</span></code></pre></div>
<pre><code>##  Joven MedianaEdad Mayores Ancianos
##                                    
##   3792       18612   10695     1012</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="análisis-exploratorio-variables.html#cb31-1"></a><span class="kw">describe</span>(train<span class="op">$</span>age_categorica)</span></code></pre></div>
<pre><code>## train$age_categorica 
##        n  missing distinct 
##    34111        0        4 
##                                                           
## Value            Joven MedianaEdad     Mayores    Ancianos
## Frequency         3792       18612       10695        1012
## Proportion       0.111       0.546       0.314       0.030</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="análisis-exploratorio-variables.html#cb33-1"></a>train<span class="op">$</span>age_categorica =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>age_categorica, <span class="dt">levels=</span>(<span class="kw">c</span>(<span class="st">&#39;MedianaEdad&#39;</span>, <span class="st">&#39;Joven&#39;</span>,<span class="st">&#39;Mayores&#39;</span>,<span class="st">&#39;Ancianos&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="análisis-exploratorio-variables.html#cb34-1"></a><span class="kw">levels</span>(train<span class="op">$</span>age_categorica)</span></code></pre></div>
<pre><code>## [1] &quot;MedianaEdad&quot; &quot;Joven&quot;       &quot;Mayores&quot;     &quot;Ancianos&quot;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="análisis-exploratorio-variables.html#cb36-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(age_categorica, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##                | term_deposit 
## age_categorica |       no  |      yes  | Row Total | 
## ---------------|-----------|-----------|-----------|
##    MedianaEdad |    17035  |     1577  |    18612  | 
##                |    1.410  |   13.749  |           | 
##                |   91.527% |    8.473% |   54.563% | 
##                |   55.062% |   49.701% |           | 
##                |   49.940% |    4.623% |           | 
## ---------------|-----------|-----------|-----------|
##          Joven |     3286  |      506  |     3792  | 
##                |    6.830  |   66.598  |           | 
##                |   86.656% |   13.344% |   11.117% | 
##                |   10.621% |   15.947% |           | 
##                |    9.633% |    1.483% |           | 
## ---------------|-----------|-----------|-----------|
##        Mayores |     9869  |      826  |    10695  | 
##                |    2.939  |   28.657  |           | 
##                |   92.277% |    7.723% |   31.354% | 
##                |   31.899% |   26.032% |           | 
##                |   28.932% |    2.422% |           | 
## ---------------|-----------|-----------|-----------|
##       Ancianos |      748  |      264  |     1012  | 
##                |   31.436  |  306.511  |           | 
##                |   73.913% |   26.087% |    2.967% | 
##                |    2.418% |    8.320% |           | 
##                |    2.193% |    0.774% |           | 
## ---------------|-----------|-----------|-----------|
##   Column Total |    30938  |     3173  |    34111  | 
##                |   90.698% |    9.302% |           | 
## ---------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="análisis-exploratorio-variables.html#cb38-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> age_categorica, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Edad del cliente&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Edad del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Se puede comprobar como las personas de mayor edad y los más jóvenes son los más propensos a contratar el depósito que las personas de mediana edad y que las personas mayores.</p>
<p>Realizamos un logit con esta variable categórica donde la categoría de referencia se encuentra en mediana edad. Aquellas personas entre 30 y 44 años.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="análisis-exploratorio-variables.html#cb39-1"></a>logit_edadcat =<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>age_categorica, <span class="dt">family=</span>(<span class="kw">binomial</span>(<span class="dt">link=</span>logit)), <span class="dt">data =</span> train)</span>
<span id="cb39-2"><a href="análisis-exploratorio-variables.html#cb39-2"></a><span class="kw">summary</span>(logit_edadcat)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ age_categorica, family = (binomial(link = logit)), 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7775  -0.4208  -0.4208  -0.4009   2.2632  
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            -2.37975    0.02632 -90.411   &lt;2e-16 ***
## age_categoricaJoven     0.50886    0.05453   9.332   &lt;2e-16 ***
## age_categoricaMayores  -0.10081    0.04477  -2.252   0.0244 *  
## age_categoricaAncianos  1.33829    0.07627  17.546   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 20760  on 34107  degrees of freedom
## AIC: 20768
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Posteriormente en la selección de variables se realizará una modificación en las categorías de esta variable.</p>
</div>
<div id="variable-balance" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Variable balance</h3>
<p>La variable balance es una variable cuantitativa situada en la escala de intervalo. Dicha variable indica el saldo del cliente.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="análisis-exploratorio-variables.html#cb41-1"></a><span class="kw">describe</span>(train<span class="op">$</span>balance)</span></code></pre></div>
<pre><code>## train$balance 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0     6531    0.999     1345     2045   -191.0      0.0 
##      .25      .50      .75      .90      .95 
##     63.5    432.0   1392.5   3570.0   5771.0 
## 
## lowest :  -8019  -6847  -4057  -3372  -3313, highest:  64343  66721  71188  81204 102127</code></pre>
<p>Variable tiene saldo negativo lo que podría limitar su transformación aunque existe otra variable en el modelo donde se indica si el cliente está o no en mora.</p>
<p>La distribución de la variable cuenta con una larga cola que hace complicado estudiar la distribución más allá de los valores iniciales.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="análisis-exploratorio-variables.html#cb43-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> balance)) <span class="op">+</span></span>
<span id="cb43-2"><a href="análisis-exploratorio-variables.html#cb43-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;Saldo del cliente&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="análisis-exploratorio-variables.html#cb45-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x=</span>balance, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Saldo del cliente&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="análisis-exploratorio-variables.html#cb47-1"></a><span class="kw">ggplot</span>(train ,<span class="kw">aes</span>(<span class="dt">x=</span>balance, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Saldo del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-21-3.png" width="672" /></p>
<p>Se comprueba como no se puede apreciar correctamente las funciones de densidad condicionadas a contratar o no el depósito. Por ello, debemos pensar en transformar nuestra variable.</p>
<p>Primero comprobamos como tener saldo negativo es distinto de estar en mora al menos con los datos que tenemos. Por ello, tendríamos que ir con más cuidado a la hora de realizar una transformación logaritmica de nuestra variable.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="análisis-exploratorio-variables.html#cb48-1"></a>balance_neg =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(balance <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb48-2"><a href="análisis-exploratorio-variables.html#cb48-2"></a><span class="kw">describe</span>(balance_neg<span class="op">$</span>balance)</span></code></pre></div>
<pre><code>## balance_neg$balance 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##     2964        0      844        1     -320      324   -938.0   -691.7 
##      .25      .50      .75      .90      .95 
##   -416.2   -232.0    -95.0    -28.0    -11.0 
## 
## lowest : -8019 -6847 -4057 -3372 -3313, highest:    -5    -4    -3    -2    -1</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="análisis-exploratorio-variables.html#cb50-1"></a><span class="kw">describe</span>(balance_neg<span class="op">$</span>default)</span></code></pre></div>
<pre><code>## balance_neg$default 
##        n  missing distinct 
##     2964        0        2 
##                       
## Value         no   yes
## Frequency   2610   354
## Proportion 0.881 0.119</code></pre>
<p>Las personas que tienen saldo negativo en nuestro data set son 2964 clientes.
Aunque los clientes que tienen un crédito en mora tan solo son 354. Representa tan solo el 12% del total con saldo negativo.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="análisis-exploratorio-variables.html#cb52-1"></a>balance_cero =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(balance <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb52-2"><a href="análisis-exploratorio-variables.html#cb52-2"></a><span class="kw">describe</span>(balance_cero<span class="op">$</span>balance)</span></code></pre></div>
<pre><code>## balance_cero$balance 
##        n  missing distinct     Info     Mean      Gmd 
##     2716        0        1        0        0        0 
##                
## Value         0
## Frequency  2716
## Proportion    1</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="análisis-exploratorio-variables.html#cb54-1"></a><span class="kw">describe</span>(balance_cero<span class="op">$</span>default)</span></code></pre></div>
<pre><code>## balance_cero$default 
##        n  missing distinct 
##     2716        0        2 
##                       
## Value         no   yes
## Frequency   2622    94
## Proportion 0.965 0.035</code></pre>
<p>Se comprueba como aquellos que tienen saldo 0 son 2716 clientes sumándoles aquellos con saldo negativo suponen 5680 observaciones mientras que las personas con mora pertenecientes a esos grupo únicamente suman 448 observaciones.</p>
<p>Por tanto, la variable default no podría explicar aquellas observaciones perdidas al realizar el logaritmo.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="análisis-exploratorio-variables.html#cb56-1"></a>balance_pos =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(balance <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb56-2"><a href="análisis-exploratorio-variables.html#cb56-2"></a><span class="kw">describe</span>(balance_pos<span class="op">$</span>balance)</span></code></pre></div>
<pre><code>## balance_pos$balance 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    28431        0     5686        1     1647     2210       24       63 
##      .25      .50      .75      .90      .95 
##      221      635     1734     4089     6429 
## 
## lowest :      1      2      3      4      5, highest:  64343  66721  71188  81204 102127</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="análisis-exploratorio-variables.html#cb58-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">log_balance =</span> <span class="kw">log10</span>(balance))</span></code></pre></div>
<pre><code>## Warning: Problem with `mutate()` input `log_balance`.
## i Se han producido NaNs
## i Input `log_balance` is `log10(balance)`.</code></pre>
<pre><code>## Warning in mask$eval_all_mutate(dots[[i]]): Se han producido NaNs</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="análisis-exploratorio-variables.html#cb61-1"></a><span class="kw">describe</span>(train<span class="op">$</span>log_balance)</span></code></pre></div>
<pre><code>## Warning in w * sort(x - mean(x)): longitud de objeto mayor no es múltiplo de la
## longitud de uno menor</code></pre>
<pre><code>## train$log_balance 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    31147     2964     5687    0.999     -Inf      NaN     -Inf   0.6021 
##      .25      .50      .75      .90      .95 
##   2.1430   2.7243   3.1926   3.5812   3.7852 
## 
## lowest :      -Inf 0.0000000 0.3010300 0.4771213 0.6020600
## highest: 4.8085013 4.8242625 4.8524068 4.9095774 5.0091406</code></pre>
<p>Se transforma la variable mediante el logaritmo para suavizar el crecimiento al principio y acrecentarlo al final.</p>
<p>Al realizar esta transformación se producen valores NaNs. En la variable balance existen 5680 valores en los cuales el cliente no tiene saldo o su saldo es negativo.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="análisis-exploratorio-variables.html#cb64-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> log_balance)) <span class="op">+</span></span>
<span id="cb64-2"><a href="análisis-exploratorio-variables.html#cb64-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;Log saldo del cliente&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 5680 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="análisis-exploratorio-variables.html#cb67-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x=</span>log_balance, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Log saldo del cliente&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 5680 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 5680 rows containing non-finite values (stat_density).</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="análisis-exploratorio-variables.html#cb71-1"></a><span class="kw">ggplot</span>(train ,<span class="kw">aes</span>(log_balance, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Log saldo del cliente&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 5680 rows containing non-finite values (stat_density).</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-25-3.png" width="672" /></p>
<p>Con esta visualización únicamente podemos intuir que aquellas personas con mayor saldo en cuenta tienen mayor probabilidad de contratar un depósito.</p>
<p>Por ello, otra opción que se podría realizar en vez de realizar el logaritmo y perder información se podría categorizar la variable respecto al saldo en cuenta.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="análisis-exploratorio-variables.html#cb73-1"></a>bal =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(balance <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb73-2"><a href="análisis-exploratorio-variables.html#cb73-2"></a><span class="kw">describe</span>(bal<span class="op">$</span>balance)</span></code></pre></div>
<pre><code>## bal$balance 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    28431        0     5686        1     1647     2210       24       63 
##      .25      .50      .75      .90      .95 
##      221      635     1734     4089     6429 
## 
## lowest :      1      2      3      4      5, highest:  64343  66721  71188  81204 102127</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="análisis-exploratorio-variables.html#cb75-1"></a><span class="kw">sd</span>(bal<span class="op">$</span>balance)</span></code></pre></div>
<pre><code>## [1] 3225.537</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="análisis-exploratorio-variables.html#cb77-1"></a><span class="kw">IQR</span>(bal<span class="op">$</span>balance)</span></code></pre></div>
<pre><code>## [1] 1513.5</code></pre>
<p>Se dividiría la variable en cuatro categorías.</p>
<p>Saldos negativos. Siendo la cantidad inferior a 0.</p>
<p>Saldos bajos. De acuerdo a nuestros datos, la media de saldos positivos se encuentra en torno a 1500 euros. Aunque está sesgada debido a la gran cantidad de saldos altos y a una gran dispersión en nuestros datos. Por ello, se aumenta el límite de esta franja hasta los 2000€. La mediana de los datos se encuentra en torno a 635 y el IQR en torno a 1500.</p>
<p>Saldos medios. Se encuentra cercanos desde la media hasta los 10000 euros.</p>
<p>Saldos altos. A partir de dicha cantidad teniendo en cuenta la distribución de nuestros datos.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="análisis-exploratorio-variables.html#cb79-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">balance_categorica =</span> <span class="kw">cut</span>(balance, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">2000</span>, <span class="dv">10000</span>, <span class="dv">105000</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Negativo&#39;</span>,<span class="st">&#39;Bajo&#39;</span>,<span class="st">&#39;Medio&#39;</span>, <span class="st">&#39;Alto&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="análisis-exploratorio-variables.html#cb80-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>balance_categorica)</span></code></pre></div>
<pre><code>##  Negativo  Bajo Medio  Alto
##                            
##      2964 24873  5649   625</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="análisis-exploratorio-variables.html#cb82-1"></a><span class="kw">describe</span>(train<span class="op">$</span>balance_categorica)</span></code></pre></div>
<pre><code>## train$balance_categorica 
##        n  missing distinct 
##    34111        0        4 
##                                               
## Value      Negativo     Bajo    Medio     Alto
## Frequency      2964    24873     5649      625
## Proportion    0.087    0.729    0.166    0.018</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="análisis-exploratorio-variables.html#cb84-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(balance_categorica, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##                    | term_deposit 
## balance_categorica |       no  |      yes  | Row Total | 
## -------------------|-----------|-----------|-----------|
##           Negativo |     2803  |      161  |     2964  | 
##                    |    4.895  |   47.726  |           | 
##                    |   94.568% |    5.432% |    8.689% | 
##                    |    9.060% |    5.074% |           | 
##                    |    8.217% |    0.472% |           | 
## -------------------|-----------|-----------|-----------|
##               Bajo |    22684  |     2189  |    24873  | 
##                    |    0.689  |    6.719  |           | 
##                    |   91.199% |    8.801% |   72.918% | 
##                    |   73.321% |   68.988% |           | 
##                    |   66.501% |    6.417% |           | 
## -------------------|-----------|-----------|-----------|
##              Medio |     4911  |      738  |     5649  | 
##                    |    8.816  |   85.960  |           | 
##                    |   86.936% |   13.064% |   16.561% | 
##                    |   15.874% |   23.259% |           | 
##                    |   14.397% |    2.164% |           | 
## -------------------|-----------|-----------|-----------|
##               Alto |      540  |       85  |      625  | 
##                    |    1.273  |   12.412  |           | 
##                    |   86.400% |   13.600% |    1.832% | 
##                    |    1.745% |    2.679% |           | 
##                    |    1.583% |    0.249% |           | 
## -------------------|-----------|-----------|-----------|
##       Column Total |    30938  |     3173  |    34111  | 
##                    |   90.698% |    9.302% |           | 
## -------------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>Al establecer las categorías en base a nuestros datos de entrenamiento se podría caer también en overfitting.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="análisis-exploratorio-variables.html#cb86-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> balance_categorica, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Saldo en cuenta cliente&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Saldos del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Se aprecia como a medida que crecen los saldos, la probabilidad de contratar un depósito aumenta.</p>
</div>
<div id="variable-job" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Variable job</h3>
<p>Variable categórica en escala nominal que muestra el tipo de puesto laboral (management, technician, entrepeneur, administrative, blue-collar, services, retired, unknown)</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="análisis-exploratorio-variables.html#cb87-1"></a>train<span class="op">$</span>job=<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>job)</span>
<span id="cb87-2"><a href="análisis-exploratorio-variables.html#cb87-2"></a><span class="kw">levels</span>(train<span class="op">$</span>job)</span></code></pre></div>
<pre><code>##  [1] &quot;admin.&quot;        &quot;blue-collar&quot;   &quot;entrepreneur&quot;  &quot;housemaid&quot;    
##  [5] &quot;management&quot;    &quot;retired&quot;       &quot;self-employed&quot; &quot;services&quot;     
##  [9] &quot;student&quot;       &quot;technician&quot;    &quot;unemployed&quot;    &quot;unknown&quot;</code></pre>
<p>Mostramos la tabla de frecuencias absolutas y relativas:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="análisis-exploratorio-variables.html#cb89-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>job)</span></code></pre></div>
<pre><code>##  admin. blue-collar entrepreneur housemaid management retired self-employed services student technician unemployed unknown
##                                                                                                                           
##    3892        7608         1137       937       7130    1503          1183     3215     581       5763        955     207</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="análisis-exploratorio-variables.html#cb91-1"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(train<span class="op">$</span>job))</span></code></pre></div>
<pre><code>##       admin. blue-collar entrepreneur   housemaid  management     retired self-employed    services     student  technician  unemployed     unknown
##                                                                                                                                                    
##  0.114098092 0.223036557  0.033332356 0.027469145 0.209023482 0.044062033   0.034680895 0.094251121 0.017032629 0.168948433 0.027996834 0.006068424</code></pre>
<p>La categoría más frecuente es la de <strong>unemployed</strong>, seguido de <strong>blue-collar</strong> y <strong>management</strong>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="análisis-exploratorio-variables.html#cb93-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(job)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>),<span class="dt">position=</span><span class="st">&#39;dodge&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Profesión del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>La cruzamos con la variable objetivo:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="análisis-exploratorio-variables.html#cb94-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(job, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##               | term_deposit 
##           job |       no  |      yes  | Row Total | 
## --------------|-----------|-----------|-----------|
##        admin. |     3509  |      383  |     3892  | 
##               |    0.125  |    1.214  |           | 
##               |   90.159% |    9.841% |   11.410% | 
##               |   11.342% |   12.071% |           | 
##               |   10.287% |    1.123% |           | 
## --------------|-----------|-----------|-----------|
##   blue-collar |     7103  |      505  |     7608  | 
##               |    5.954  |   58.055  |           | 
##               |   93.362% |    6.638% |   22.304% | 
##               |   22.959% |   15.916% |           | 
##               |   20.823% |    1.480% |           | 
## --------------|-----------|-----------|-----------|
##  entrepreneur |     1061  |       76  |     1137  | 
##               |    0.859  |    8.376  |           | 
##               |   93.316% |    6.684% |    3.333% | 
##               |    3.429% |    2.395% |           | 
##               |    3.110% |    0.223% |           | 
## --------------|-----------|-----------|-----------|
##     housemaid |      873  |       64  |      937  | 
##               |    0.631  |    6.154  |           | 
##               |   93.170% |    6.830% |    2.747% | 
##               |    2.822% |    2.017% |           | 
##               |    2.559% |    0.188% |           | 
## --------------|-----------|-----------|-----------|
##    management |     6345  |      785  |     7130  | 
##               |    2.293  |   22.357  |           | 
##               |   88.990% |   11.010% |   20.902% | 
##               |   20.509% |   24.740% |           | 
##               |   18.601% |    2.301% |           | 
## --------------|-----------|-----------|-----------|
##       retired |     1250  |      253  |     1503  | 
##               |    9.399  |   91.641  |           | 
##               |   83.167% |   16.833% |    4.406% | 
##               |    4.040% |    7.974% |           | 
##               |    3.665% |    0.742% |           | 
## --------------|-----------|-----------|-----------|
## self-employed |     1073  |      110  |     1183  | 
##               |    0.000  |    0.000  |           | 
##               |   90.702% |    9.298% |    3.468% | 
##               |    3.468% |    3.467% |           | 
##               |    3.146% |    0.322% |           | 
## --------------|-----------|-----------|-----------|
##      services |     2980  |      235  |     3215  | 
##               |    1.407  |   13.721  |           | 
##               |   92.691% |    7.309% |    9.425% | 
##               |    9.632% |    7.406% |           | 
##               |    8.736% |    0.689% |           | 
## --------------|-----------|-----------|-----------|
##       student |      462  |      119  |      581  | 
##               |    8.007  |   78.069  |           | 
##               |   79.518% |   20.482% |    1.703% | 
##               |    1.493% |    3.750% |           | 
##               |    1.354% |    0.349% |           | 
## --------------|-----------|-----------|-----------|
##    technician |     5244  |      519  |     5763  | 
##               |    0.056  |    0.544  |           | 
##               |   90.994% |    9.006% |   16.895% | 
##               |   16.950% |   16.357% |           | 
##               |   15.373% |    1.522% |           | 
## --------------|-----------|-----------|-----------|
##    unemployed |      848  |      107  |      955  | 
##               |    0.381  |    3.715  |           | 
##               |   88.796% |   11.204% |    2.800% | 
##               |    2.741% |    3.372% |           | 
##               |    2.486% |    0.314% |           | 
## --------------|-----------|-----------|-----------|
##       unknown |      190  |       17  |      207  | 
##               |    0.027  |    0.264  |           | 
##               |   91.787% |    8.213% |    0.607% | 
##               |    0.614% |    0.536% |           | 
##               |    0.557% |    0.050% |           | 
## --------------|-----------|-----------|-----------|
##  Column Total |    30938  |     3173  |    34111  | 
##               |   90.698% |    9.302% |           | 
## --------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>Con la tabla de frecuencias se observa que el porcentaje de contratación del depósito varía según nivel de empleo.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="análisis-exploratorio-variables.html#cb96-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> job, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según profesión del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="análisis-exploratorio-variables.html#cb97-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> job, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ),<span class="dt">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según profesión del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="análisis-exploratorio-variables.html#cb98-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> job, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;tipo de puesto laboral&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según profesión del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<p>Estudiante es el estado profesional más propenso a contratar el producto, seguido de jubilado. Pero todas las profesiones parecen ser buenos discriminadores de la probabilidad de contratación. Por lo que esta variable parece que pueda ser una buena variable predictora.</p>
<p>Hallamos la regresión logística múltiple en función de la variable job mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="análisis-exploratorio-variables.html#cb99-1"></a>train<span class="op">$</span>job[train<span class="op">$</span>job <span class="op">==</span><span class="st"> &quot;blue-collar&quot;</span>] &lt;-<span class="st">&quot;blue_collar&quot;</span></span></code></pre></div>
<pre><code>## Warning in `[&lt;-.factor`(`*tmp*`, train$job == &quot;blue-collar&quot;, value =
## structure(c(1L, : invalid factor level, NA generated</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="análisis-exploratorio-variables.html#cb101-1"></a>train<span class="op">$</span>job[train<span class="op">$</span>job <span class="op">==</span><span class="st"> &quot;self-employed&quot;</span>] &lt;-<span class="st">&quot;self_employed&quot;</span></span></code></pre></div>
<pre><code>## Warning in `[&lt;-.factor`(`*tmp*`, train$job == &quot;self-employed&quot;, value =
## structure(c(1L, : invalid factor level, NA generated</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="análisis-exploratorio-variables.html#cb103-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;job&quot;</span>))</span>
<span id="cb103-2"><a href="análisis-exploratorio-variables.html#cb103-2"></a>modelo.log.m.job &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>job, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb103-3"><a href="análisis-exploratorio-variables.html#cb103-3"></a><span class="kw">summary</span>(modelo.log.m.job)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ job, family = binomial, 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.6770  -0.4830  -0.4345  -0.3896   2.3261  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -2.21505    0.05381 -41.161  &lt; 2e-16 ***
## jobentrepreneur -0.42118    0.13037  -3.231 0.001235 ** 
## jobhousemaid    -0.39800    0.14024  -2.838 0.004539 ** 
## jobmanagement    0.12531    0.06578   1.905 0.056789 .  
## jobretired       0.61754    0.08746   7.061 1.65e-12 ***
## jobservices     -0.32504    0.08653  -3.757 0.000172 ***
## jobstudent       0.85861    0.11603   7.400 1.37e-13 ***
## jobtechnician   -0.09788    0.07081  -1.382 0.166836    
## jobunemployed    0.14500    0.11585   1.252 0.210706    
## jobunknown      -0.19876    0.25881  -0.768 0.442503    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 16576  on 25319  degrees of freedom
## Residual deviance: 16382  on 25310  degrees of freedom
##   (8791 observations deleted due to missingness)
## AIC: 16402
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Obtenemos los intervaleos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="análisis-exploratorio-variables.html#cb105-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.job , <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                        2.5 %      97.5 %
## (Intercept)     -2.322046533 -2.11104003
## jobentrepreneur -0.683303370 -0.17156853
## jobhousemaid    -0.681013991 -0.13040880
## jobmanagement   -0.002893356  0.25504234
## jobretired       0.445369745  0.78832996
## jobservices     -0.495677094 -0.15633666
## jobstudent       0.628183294  1.08338812
## jobtechnician   -0.236311421  0.04132549
## jobunemployed   -0.086062909  0.36848112
## jobunknown      -0.742160419  0.27867447</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables job_student y job_retired con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan. Los estudiantes tienen asociado un coeficiente positivo (1.027) y los retirados 0.702. A mayor valor del coeficiente, mayor probabilidad de contratación.</p>
</div>
<div id="variable-marital" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Variable marital</h3>
<p>Variable categórica en escala nominal, muestra el estado civil (married, single, divorced).</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="análisis-exploratorio-variables.html#cb108-1"></a>train<span class="op">$</span>marital =<span class="st"> </span><span class="kw">factor</span> (train<span class="op">$</span>marital)</span>
<span id="cb108-2"><a href="análisis-exploratorio-variables.html#cb108-2"></a><span class="kw">levels</span>(train<span class="op">$</span>marital)</span></code></pre></div>
<pre><code>## [1] &quot;divorced&quot; &quot;married&quot;  &quot;single&quot;</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="análisis-exploratorio-variables.html#cb110-1"></a>reorder_marital =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>marital, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&#39;single&#39;</span>,<span class="st">&#39;married&#39;</span>,<span class="st">&#39;divorce&#39;</span>)))</span>
<span id="cb110-2"><a href="análisis-exploratorio-variables.html#cb110-2"></a><span class="kw">levels</span>(reorder_marital)</span></code></pre></div>
<pre><code>## [1] &quot;single&quot;  &quot;married&quot; &quot;divorce&quot;</code></pre>
<p>Mostramos la tabla de frecuencias absolutas y relativas:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="análisis-exploratorio-variables.html#cb112-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>marital)</span></code></pre></div>
<pre><code>##  divorced married single
##                         
##      3982   20680   9449</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="análisis-exploratorio-variables.html#cb114-1"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(train<span class="op">$</span>marital))</span></code></pre></div>
<pre><code>##   divorced   married    single
##                               
##  0.1167365 0.6062560 0.2770074</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="análisis-exploratorio-variables.html#cb116-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(marital)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Estado civil del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>El estado civil más numeroso es casado.</p>
<p>La cruzamos con la variable objetivo:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="análisis-exploratorio-variables.html#cb117-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(marital, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##      marital |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##     divorced |     3575  |      407  |     3982  | 
##              |    0.371  |    3.615  |           | 
##              |   89.779% |   10.221% |   11.674% | 
##              |   11.555% |   12.827% |           | 
##              |   10.480% |    1.193% |           | 
## -------------|-----------|-----------|-----------|
##      married |    19008  |     1672  |    20680  | 
##              |    3.376  |   32.921  |           | 
##              |   91.915% |    8.085% |   60.626% | 
##              |   61.439% |   52.695% |           | 
##              |   55.724% |    4.902% |           | 
## -------------|-----------|-----------|-----------|
##       single |     8355  |     1094  |     9449  | 
##              |    5.397  |   52.619  |           | 
##              |   88.422% |   11.578% |   27.701% | 
##              |   27.006% |   34.478% |           | 
##              |   24.494% |    3.207% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>En la tabla de frecuencias se observa que el porcentaje de contratación varía según el estado civil del cliente. Por este motivo, parece interesante dumificar la variable y hallar la regresión logística para ver si la diferencia entre las categorías es significativa.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="análisis-exploratorio-variables.html#cb119-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> marital, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según estado civil del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="análisis-exploratorio-variables.html#cb120-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> marital, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frecuencia de contratación de depósito según estado civil del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-44-2.png" width="672" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="análisis-exploratorio-variables.html#cb121-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> marital, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;tipo de puesto laboral&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación por estado civil del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-44-3.png" width="672" /></p>
<p>Soltero es el estado civil más propenso a contratar el producto, seguido muy de cerca de los divorciados y bastante alejado se encuentra el grupo de casados. Sin duda esta variable es informativa para un futuro modelo.</p>
<p>Hallamos la regresión logística múltiple en función de la variable marital mediante sus categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="análisis-exploratorio-variables.html#cb122-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;marital&quot;</span>))</span>
<span id="cb122-2"><a href="análisis-exploratorio-variables.html#cb122-2"></a>modelo.log.m.marital &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>marital, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb122-3"><a href="análisis-exploratorio-variables.html#cb122-3"></a><span class="kw">summary</span>(modelo.log.m.marital)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ marital, family = binomial, 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4961  -0.4644  -0.4106  -0.4106   2.2428  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -2.17291    0.05231 -41.536  &lt; 2e-16 ***
## maritalmarried -0.25793    0.05820  -4.432 9.35e-06 ***
## maritalsingle   0.13989    0.06140   2.278   0.0227 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 21017  on 34108  degrees of freedom
## AIC: 21023
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Obtenemos los intervalos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="análisis-exploratorio-variables.html#cb124-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.marital , <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                      2.5 %     97.5 %
## (Intercept)    -2.27686396 -2.0717436
## maritalmarried -0.37097222 -0.1427697
## maritalsingle   0.02038193  0.2611420</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables marital_married y marital_single con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan.</p>
<p>Los casados tienen asociado un coeficiente negativo (-0.21937) y los retirados un coeficiente positivo (0.21013). A mayor valor del coeficiente, mayor probabilidad de contratación. La diferencia de la probabilidad de contratación entre los distintos niveles categóricos es significativa, aumentando esta para los solteros y disminuyendo para los casados.</p>
</div>
<div id="variable-education" class="section level3">
<h3><span class="header-section-number">2.4.5</span> Variable education</h3>
<p>Variable categórica en escala nominal que informa del nivel educativo del cliente, muestra el nivel de educación (primary, secondary, tertiary, unknown).</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="análisis-exploratorio-variables.html#cb127-1"></a>train<span class="op">$</span>education =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>education)</span>
<span id="cb127-2"><a href="análisis-exploratorio-variables.html#cb127-2"></a><span class="kw">levels</span>(train<span class="op">$</span>education)</span></code></pre></div>
<pre><code>## [1] &quot;primary&quot;   &quot;secondary&quot; &quot;tertiary&quot;  &quot;unknown&quot;</code></pre>
<p>Mostramos la tabla de frecuencias absolutas y relativas:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="análisis-exploratorio-variables.html#cb129-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>education)</span></code></pre></div>
<pre><code>##  primary secondary tertiary unknown
##                                    
##     5272     17645     9847    1347</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="análisis-exploratorio-variables.html#cb131-1"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(train<span class="op">$</span>education))</span></code></pre></div>
<pre><code>##     primary  secondary   tertiary    unknown
##                                             
##  0.15455425 0.51728182 0.28867521 0.03948873</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="análisis-exploratorio-variables.html#cb133-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(education)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Nivel educativo del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Secondary es el nivel educativo más común seguido de lejos por tertiary y primary. Existe un pequeño porcentaje de clientes que no ha contestado la pregunta.</p>
<p>La cruzamos con la variable objetivo:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="análisis-exploratorio-variables.html#cb134-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(education, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##    education |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##      primary |     4894  |      378  |     5272  | 
##              |    2.642  |   25.762  |           | 
##              |   92.830% |    7.170% |   15.455% | 
##              |   15.819% |   11.913% |           | 
##              |   14.347% |    1.108% |           | 
## -------------|-----------|-----------|-----------|
##    secondary |    16166  |     1479  |    17645  | 
##              |    1.647  |   16.056  |           | 
##              |   91.618% |    8.382% |   51.728% | 
##              |   52.253% |   46.612% |           | 
##              |   47.392% |    4.336% |           | 
## -------------|-----------|-----------|-----------|
##     tertiary |     8660  |     1187  |     9847  | 
##              |    8.225  |   80.199  |           | 
##              |   87.946% |   12.054% |   28.868% | 
##              |   27.991% |   37.409% |           | 
##              |   25.388% |    3.480% |           | 
## -------------|-----------|-----------|-----------|
##      unknown |     1218  |      129  |     1347  | 
##              |    0.011  |    0.109  |           | 
##              |   90.423% |    9.577% |    3.949% | 
##              |    3.937% |    4.066% |           | 
##              |    3.571% |    0.378% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="análisis-exploratorio-variables.html#cb136-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> education, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según el nivel educativo del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="análisis-exploratorio-variables.html#cb137-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> education, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frecuencia de nivel educativo del cliente por contratación&quot;)</span></span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-52-2.png" width="672" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="análisis-exploratorio-variables.html#cb138-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> education, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Nivel de educación&#39;, y = &#39;</span>prop<span class="st">&#39;) + ggtitle(&quot;Contratación por nivel de estudios.&quot;)</span></span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-52-3.png" width="672" /></p>
<p>Con el análisis gráfico se observa una ligera diferencia de contratación del depósito en función del nivel educativo. El grupo más propenso a contratar el producto es <strong>secondary</strong>. Pero no hay diferencias tan notables como en otras variables categóricas como job o marital.</p>
<p>El grupo que no ha respondido a esta variable se asemeja a secondary en cuanto a densidad de contrataciones se refiere. Este hecho es recomendable tenerlo en cuenta a la hora de tratar los valores perdidos.</p>
<p>Hallamos la regresión logística múltiple en función de la variable education mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple en función de los niveles educativos, excluyendo la categoría unknown porque entendemos que en este grupo se acumulan datos de las tres categorías disminuyendo la explicabilidad del modelo si está en función de esta variable dummy.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="análisis-exploratorio-variables.html#cb139-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;education&quot;</span>))</span>
<span id="cb139-2"><a href="análisis-exploratorio-variables.html#cb139-2"></a>modelo.log.m.education &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>education_primary <span class="op">+</span><span class="st"> </span>education_secondary <span class="op">+</span><span class="st"> </span>education_tertiary, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb139-3"><a href="análisis-exploratorio-variables.html#cb139-3"></a><span class="kw">summary</span>(modelo.log.m.education)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ education_primary + education_secondary + 
##     education_tertiary, family = binomial, data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.5069  -0.5069  -0.4184  -0.4184   2.2958  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -2.24515    0.09259 -24.248  &lt; 2e-16 ***
## education_primary   -0.31572    0.10688  -2.954  0.00314 ** 
## education_secondary -0.14639    0.09649  -1.517  0.12924    
## education_tertiary   0.25787    0.09763   2.641  0.00826 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 20982  on 34107  degrees of freedom
## AIC: 20990
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Obtenemos los intervaleos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="análisis-exploratorio-variables.html#cb141-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.education , <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                          2.5 %      97.5 %
## (Intercept)         -2.4312250 -2.06797435
## education_primary   -0.5224124 -0.10312598
## education_secondary -0.3316027  0.04694852
## education_tertiary   0.0703250  0.45331803</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables education_primary y education_tertiary con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan.</p>
<p>A niveles altos de educación, mayor es la probabilidad de contratación. A niveles bajos de educación, la probabilidad de contratación es menor. A niveles intermedios de educación no podemos afirmar nada con el modelo logístico calculado.</p>
</div>
<div id="variable-default" class="section level3">
<h3><span class="header-section-number">2.4.6</span> Variable default</h3>
<p>Variable categórica en escala binaria. Indica si un cliente tiene mora o no.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="análisis-exploratorio-variables.html#cb144-1"></a>train<span class="op">$</span>default =<span class="st"> </span><span class="kw">factor</span> (train<span class="op">$</span>default)</span>
<span id="cb144-2"><a href="análisis-exploratorio-variables.html#cb144-2"></a><span class="kw">levels</span>(train<span class="op">$</span>default)</span></code></pre></div>
<pre><code>## [1] &quot;no&quot;  &quot;yes&quot;</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="análisis-exploratorio-variables.html#cb146-1"></a>reorder_default =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>default, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&#39;no&#39;</span>,<span class="st">&#39;yes&#39;</span>)))</span>
<span id="cb146-2"><a href="análisis-exploratorio-variables.html#cb146-2"></a><span class="kw">levels</span>(reorder_default)</span></code></pre></div>
<pre><code>## [1] &quot;no&quot;  &quot;yes&quot;</code></pre>
<p>Mostramos la tabla de frecuencias absolutas y relativas:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="análisis-exploratorio-variables.html#cb148-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>default)</span></code></pre></div>
<pre><code>##     no   yes
##             
##  33463   648</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="análisis-exploratorio-variables.html#cb150-1"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(train<span class="op">$</span>default))</span></code></pre></div>
<pre><code>##         no       yes
##                     
##  0.9810032 0.0189968</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="análisis-exploratorio-variables.html#cb152-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(default)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Default del cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Sin duda el grupo más numeroso con gran diferencia es el de aquellos sin deudas.</p>
<p>La cruzamos con la variable objetivo:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="análisis-exploratorio-variables.html#cb153-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(default, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##      default |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##           no |    30329  |     3134  |    33463  | 
##              |    0.015  |    0.145  |           | 
##              |   90.634% |    9.366% |   98.100% | 
##              |   98.032% |   98.771% |           | 
##              |   88.913% |    9.188% |           | 
## -------------|-----------|-----------|-----------|
##          yes |      609  |       39  |      648  | 
##              |    0.770  |    7.510  |           | 
##              |   93.981% |    6.019% |    1.900% | 
##              |    1.968% |    1.229% |           | 
##              |    1.785% |    0.114% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="análisis-exploratorio-variables.html#cb155-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> default, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según si el cliente tiene mora&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="análisis-exploratorio-variables.html#cb156-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> default, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frecuencia de contratación de depósito según si el cliente tiene mora&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-60-2.png" width="672" /></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="análisis-exploratorio-variables.html#cb157-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> default, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Default&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación por morosidad.&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-60-3.png" width="672" /></p>
<p>Como era de esperar, aquellos con deudas pendientes son menos propensos a contratar el producto, por lo que esta variable parece ser una buena canditrain a ser variable predictora.</p>
<p>Hallamos la regresión logística múltiple en función de la variable default mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple, para observar las diferencias en probabilidad para cada variable categórica.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="análisis-exploratorio-variables.html#cb158-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;default&quot;</span>))</span>
<span id="cb158-2"><a href="análisis-exploratorio-variables.html#cb158-2"></a>modelo.log.m.default &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>default, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb158-3"><a href="análisis-exploratorio-variables.html#cb158-3"></a><span class="kw">summary</span>(modelo.log.m.default)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ default, family = binomial, 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4435  -0.4435  -0.4435  -0.4435   2.3708  
## 
## Coefficients:
##             Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept) -2.26979    0.01876 -120.971   &lt;2e-16 ***
## defaultyes  -0.47846    0.16624   -2.878    0.004 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 21103  on 34109  degrees of freedom
## AIC: 21107
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Obtenemos los intervalos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="análisis-exploratorio-variables.html#cb160-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.default, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) -2.3067539 -2.2332015
## defaultyes  -0.8203801 -0.1669569</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables dumis default con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan. Como el coeficiente asociado a la variable default_yes es negativo, si el cliente es moroso, tiene menos probabilidad de contratación del depósito.</p>
</div>
<div id="variable-housing" class="section level3">
<h3><span class="header-section-number">2.4.7</span> Variable housing</h3>
<p>La variable housing es una variable dicotomica que muestra si tiene un préstamo hipotecario.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="análisis-exploratorio-variables.html#cb163-1"></a>train<span class="op">$</span>housing =<span class="st"> </span><span class="kw">factor</span> (train<span class="op">$</span>housing)</span>
<span id="cb163-2"><a href="análisis-exploratorio-variables.html#cb163-2"></a><span class="kw">levels</span>(train<span class="op">$</span>housing)</span></code></pre></div>
<pre><code>## [1] &quot;no&quot;  &quot;yes&quot;</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="análisis-exploratorio-variables.html#cb165-1"></a>reorder_housing =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>housing, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&#39;no&#39;</span>,<span class="st">&#39;yes&#39;</span>)))</span>
<span id="cb165-2"><a href="análisis-exploratorio-variables.html#cb165-2"></a><span class="kw">levels</span>(reorder_housing)</span></code></pre></div>
<pre><code>## [1] &quot;no&quot;  &quot;yes&quot;</code></pre>
<p>Tabla de frecuencias absolutas y relativas:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="análisis-exploratorio-variables.html#cb167-1"></a><span class="kw">table</span>(train<span class="op">$</span>housing)</span></code></pre></div>
<pre><code>## 
##    no   yes 
## 14509 19602</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="análisis-exploratorio-variables.html#cb169-1"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(train<span class="op">$</span>housing))</span></code></pre></div>
<pre><code>## 
##        no       yes 
## 0.4253467 0.5746533</code></pre>
<p>De manera gráfica:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="análisis-exploratorio-variables.html#cb171-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(housing)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Tenencia de préstamo hipotecario&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>Se encuentran balanceado los datos y con mayor proporción en tener un préstamo hipotecario</p>
<p>Si evaluamos la variable housing respecto a nuestra variable objetivo (term_deposit)</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="análisis-exploratorio-variables.html#cb172-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(housing, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##      housing |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##           no |    12694  |     1815  |    14509  | 
##              |   16.458  |  160.470  |           | 
##              |   87.491% |   12.509% |   42.535% | 
##              |   41.030% |   57.201% |           | 
##              |   37.214% |    5.321% |           | 
## -------------|-----------|-----------|-----------|
##          yes |    18244  |     1358  |    19602  | 
##              |   12.182  |  118.776  |           | 
##              |   93.072% |    6.928% |   57.465% | 
##              |   58.970% |   42.799% |           | 
##              |   53.484% |    3.981% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>En la tabla de frecuencias se observa que los clientes que no tienen hipoteca tienen más probabilidad de contratar el depósito, frente a los que la tienen.</p>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="análisis-exploratorio-variables.html#cb174-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> housing, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación depósito según tenencia de hipoteca&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="análisis-exploratorio-variables.html#cb175-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> housing, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación depósito según tenencia de hipoteca&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-67-2.png" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="análisis-exploratorio-variables.html#cb176-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> housing, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Housing&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación por tenencia de hipoteca&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-67-3.png" width="672" /></p>
<p>Se comprueba que en términos relativos aquellos que contratan el depósito tienen mayor proporción de individuos que no cuenta con préstamo hipotecario. Al contrario ocurre con los que no contratan el depósito siendo en mayor proporción aquellos que sí tiene una hipoteca.</p>
<p>Hallamos la regresión logística múltiple en función de la variable Housing mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple para observar si es significativa la tenencia de una hipoteca para la contratación del depósito.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="análisis-exploratorio-variables.html#cb177-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;housing&quot;</span>))</span>
<span id="cb177-2"><a href="análisis-exploratorio-variables.html#cb177-2"></a>modelo.log.m.housing &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>housing, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb177-3"><a href="análisis-exploratorio-variables.html#cb177-3"></a><span class="kw">summary</span>(modelo.log.m.housing)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ housing, family = binomial, 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.5170  -0.5170  -0.3789  -0.3789   2.3107  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.94504    0.02509  -77.51   &lt;2e-16 ***
## housingyes  -0.65278    0.03770  -17.32   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 20809  on 34109  degrees of freedom
## AIC: 20813
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Obtenemos los intervalos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="análisis-exploratorio-variables.html#cb179-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.housing, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) -1.9945343 -1.8961592
## housingyes  -0.7267761 -0.5790008</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables dumis housing con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan. Como el coeficiente asociado a la variable housing_yes es negativo, si el cliente tiene hipoteca, tiene menos probabilidad de contratación.</p>
</div>
<div id="variable-loan" class="section level3">
<h3><span class="header-section-number">2.4.8</span> Variable loan</h3>
<p>La variable loan es una variable dicotómica que muestra si el cliente tiene un préstamo personal.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="análisis-exploratorio-variables.html#cb182-1"></a>train<span class="op">$</span>loan =<span class="st"> </span><span class="kw">factor</span> (train<span class="op">$</span>loan)</span>
<span id="cb182-2"><a href="análisis-exploratorio-variables.html#cb182-2"></a><span class="kw">levels</span>(train<span class="op">$</span>loan)</span></code></pre></div>
<pre><code>## [1] &quot;no&quot;  &quot;yes&quot;</code></pre>
<p>Al ser una variable categórica realizamos una tabla de frecuencias absoluta y de frecuencias relativa para ver su composición de forma univariante.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="análisis-exploratorio-variables.html#cb184-1"></a><span class="kw">table</span>(train<span class="op">$</span>loan)</span></code></pre></div>
<pre><code>## 
##    no   yes 
## 28463  5648</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="análisis-exploratorio-variables.html#cb186-1"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(train<span class="op">$</span>loan))</span></code></pre></div>
<pre><code>## 
##        no       yes 
## 0.8344229 0.1655771</code></pre>
<p>De manera gráfica</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="análisis-exploratorio-variables.html#cb188-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(loan)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Tenencia de préstamo personal&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>La gran parte de los clientes no tienen un préstamo personal.</p>
<p>Si evaluamos la variable loan respecto a nuestra variable objetivo (term_deposit)</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="análisis-exploratorio-variables.html#cb189-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(loan, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##         loan |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##           no |    25636  |     2827  |    28463  | 
##              |    1.246  |   12.153  |           | 
##              |   90.068% |    9.932% |   83.442% | 
##              |   82.862% |   89.095% |           | 
##              |   75.155% |    8.288% |           | 
## -------------|-----------|-----------|-----------|
##          yes |     5302  |      346  |     5648  | 
##              |    6.281  |   61.243  |           | 
##              |   93.874% |    6.126% |   16.558% | 
##              |   17.138% |   10.905% |           | 
##              |   15.543% |    1.014% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="análisis-exploratorio-variables.html#cb191-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> loan, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación depósito según tenencia de préstamo&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="análisis-exploratorio-variables.html#cb192-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> loan, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación depósito según tenencia de préstamo&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-74-2.png" width="672" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="análisis-exploratorio-variables.html#cb193-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> loan, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Loan&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación por tenencia de préstamo personal&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-74-3.png" width="672" /></p>
<p>Se comprueba que en términos relativos aquellos que contratan el depósito tienen una proporción parecida a las que no lo contratan en cuanto a la tenencia de préstamo personal. Aunque son aquellos que no contratan el préstamo los que tienen mayor proporción de tener un préstamo personal.</p>
<p>Hallamos la regresión logística múltiple en función de la variable loan mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="análisis-exploratorio-variables.html#cb194-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;loan&quot;</span>))</span>
<span id="cb194-2"><a href="análisis-exploratorio-variables.html#cb194-2"></a>modelo.log.m.loan&lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>loan, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb194-3"><a href="análisis-exploratorio-variables.html#cb194-3"></a><span class="kw">summary</span>(modelo.log.m.loan)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ loan, family = binomial, 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4574  -0.4574  -0.4574  -0.4574   2.3633  
## 
## Coefficients:
##             Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept) -2.20478    0.01982 -111.253   &lt;2e-16 ***
## loanyes     -0.52462    0.05892   -8.904   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 21024  on 34109  degrees of freedom
## AIC: 21028
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Obtenemos los intervalos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="análisis-exploratorio-variables.html#cb196-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.loan, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) -2.2438267 -2.1661400
## loanyes     -0.6416482 -0.4106181</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables dumis loan con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan. Como el coeficiente asociado a la variable loan_yes es negativo, si el cliente tiene préstamo personal, tiene menos probabilidad de contratación.</p>
</div>
<div id="variable-contact" class="section level3">
<h3><span class="header-section-number">2.4.9</span> Variable contact</h3>
<p>La variable contact es una variable categórica en escala nominal que indica la forma en la que se contactó con el cliente. (A través de teléfono móvil, fijo, desconocido)</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="análisis-exploratorio-variables.html#cb199-1"></a>train<span class="op">$</span>contact =<span class="st"> </span><span class="kw">factor</span> (train<span class="op">$</span>contact)</span>
<span id="cb199-2"><a href="análisis-exploratorio-variables.html#cb199-2"></a><span class="kw">levels</span>(train<span class="op">$</span>contact)</span></code></pre></div>
<pre><code>## [1] &quot;cellular&quot;  &quot;telephone&quot; &quot;unknown&quot;</code></pre>
<p>Al ser una variable categórica también realizamos una tabla de frecuencias absoluta y de frecuencias relativa para ver su composición de forma univariante.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="análisis-exploratorio-variables.html#cb201-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>contact)</span></code></pre></div>
<pre><code>##  cellular telephone unknown
##                            
##     21769      2097   10245</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="análisis-exploratorio-variables.html#cb203-1"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(train<span class="op">$</span>contact))</span></code></pre></div>
<pre><code>##    cellular  telephone    unknown
##                                  
##  0.63818123 0.06147577 0.30034300</code></pre>
<p>Muestra que un gran porcentaje de los clientes fueron contactados a través del teléfono móvil.</p>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="análisis-exploratorio-variables.html#cb205-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(contact)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Forma de contacto con la persona&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>Si evaluamos la variable contact respecto a nuestra variable objetivo (term_deposit)</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="análisis-exploratorio-variables.html#cb206-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(contact, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##      contact |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##     cellular |    19228  |     2541  |    21769  | 
##              |   13.488  |  131.514  |           | 
##              |   88.327% |   11.673% |   63.818% | 
##              |   62.150% |   80.082% |           | 
##              |   56.369% |    7.449% |           | 
## -------------|-----------|-----------|-----------|
##    telephone |     1878  |      219  |     2097  | 
##              |    0.301  |    2.938  |           | 
##              |   89.557% |   10.443% |    6.148% | 
##              |    6.070% |    6.902% |           | 
##              |    5.506% |    0.642% |           | 
## -------------|-----------|-----------|-----------|
##      unknown |     9832  |      413  |    10245  | 
##              |   31.380  |  305.972  |           | 
##              |   95.969% |    4.031% |   30.034% | 
##              |   31.780% |   13.016% |           | 
##              |   28.824% |    1.211% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="análisis-exploratorio-variables.html#cb208-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> contact, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según forma de contacto&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="análisis-exploratorio-variables.html#cb209-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> contact, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según forma de contacto&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-81-2.png" width="672" /></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="análisis-exploratorio-variables.html#cb210-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> contact, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Contact&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación por tipo de toma de contacto &quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-81-3.png" width="672" /></p>
<p>Observamos que la gran mayoría de las personas que contrataron el depósito fueron contactadas a través del teléfono móvil.</p>
<p>La categoría <strong>unknown</strong> no parece mostrar que sea MCAR ya que la probabilidad de contratar parece decrecer enormemente si aparece este valor. Al contrario que para <strong>cellular</strong> o <strong>telephone</strong> donde la diferencia entre ambas es mucho más pequeña.</p>
<p>Por ello es razonable pensar que es útil mantener esta categoría ya que puede aportar valor informativo.</p>
<p>Hallamos la regresión logística múltiple en función de la variable contact mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="análisis-exploratorio-variables.html#cb211-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;contact&quot;</span>))</span>
<span id="cb211-2"><a href="análisis-exploratorio-variables.html#cb211-2"></a>modelo.log.m.contact&lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>contact, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb211-3"><a href="análisis-exploratorio-variables.html#cb211-3"></a><span class="kw">summary</span>(modelo.log.m.contact)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ contact, family = binomial, 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4982  -0.4982  -0.4982  -0.2869   2.5342  
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -2.02381    0.02111  -95.88   &lt;2e-16 ***
## contacttelephone -0.12508    0.07446   -1.68    0.093 .  
## contactunknown   -1.14614    0.05447  -21.04   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 20554  on 34108  degrees of freedom
## AIC: 20560
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables dumis loan con pvalores menores que el nivel de significación impuesto (alfa = 0.05). En este caso solo <strong>unknown</strong>.</p>
<p>Obtenemos los intervalos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="análisis-exploratorio-variables.html#cb213-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.contact, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                       2.5 %      97.5 %
## (Intercept)      -2.0654018 -1.98265592
## contacttelephone -0.2734507  0.01856387
## contactunknown   -1.2541868 -1.04055704</code></pre>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan. Como el coeficiente asociado a la variable loan_yes es negativo, si el cliente tiene préstamo personal, tiene menos probabilidad de contratación.</p>
</div>
<div id="variable-mes" class="section level3">
<h3><span class="header-section-number">2.4.10</span> Variable mes</h3>
<p>La variable mes es una variable categórica que indica en qué mes se produjo el último contacto con el cliente.</p>
<p>Reasignamos los valores de la variable para que aparezcan en orden.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="análisis-exploratorio-variables.html#cb216-1"></a>meses =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>month, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;jan&quot;</span>, <span class="st">&quot;feb&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;apr&quot;</span>, <span class="st">&quot;may&quot;</span>, <span class="st">&quot;jun&quot;</span>,</span>
<span id="cb216-2"><a href="análisis-exploratorio-variables.html#cb216-2"></a>                                        <span class="st">&quot;jul&quot;</span>, <span class="st">&quot;aug&quot;</span>, <span class="st">&quot;sep&quot;</span>, <span class="st">&quot;oct&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;dec&quot;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="análisis-exploratorio-variables.html#cb217-1"></a>train_tmp =<span class="st"> </span>train</span>
<span id="cb217-2"><a href="análisis-exploratorio-variables.html#cb217-2"></a>train_tmp<span class="op">$</span>month =<span class="st"> </span><span class="kw">factor</span> (train_tmp<span class="op">$</span>month)</span>
<span id="cb217-3"><a href="análisis-exploratorio-variables.html#cb217-3"></a><span class="kw">levels</span>(train_tmp<span class="op">$</span>month)</span></code></pre></div>
<pre><code>##  [1] &quot;apr&quot; &quot;aug&quot; &quot;dec&quot; &quot;feb&quot; &quot;jan&quot; &quot;jul&quot; &quot;jun&quot; &quot;mar&quot; &quot;may&quot; &quot;nov&quot; &quot;oct&quot; &quot;sep&quot;</code></pre>
<p>Al ser una variable categórica también realizamos una tabla de frecuencias absoluta y de frecuencias relativa para ver su composición de forma univariante.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="análisis-exploratorio-variables.html#cb219-1"></a><span class="kw">ftable</span>(train_tmp<span class="op">$</span>month)</span></code></pre></div>
<pre><code>##    apr   aug   dec   feb   jan   jul   jun   mar   may   nov   oct   sep
##                                                                         
##   2142  4813   171  1823   969  5244  4125   214 10852  3113   419   226</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="análisis-exploratorio-variables.html#cb221-1"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(train_tmp<span class="op">$</span>month))</span></code></pre></div>
<pre><code>##          apr         aug         dec         feb         jan         jul         jun         mar         may         nov         oct         sep
##                                                                                                                                                 
##  0.062794993 0.141098179 0.005013046 0.053443171 0.028407259 0.153733400 0.120928733 0.006273636 0.318137844 0.091260884 0.012283428 0.006625429</code></pre>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="análisis-exploratorio-variables.html#cb223-1"></a><span class="kw">ggplot</span>(train_tmp, <span class="kw">aes</span>(month)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mes&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>Si evaluamos la variable month respecto a nuestra variable objetivo (term_deposit)</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="análisis-exploratorio-variables.html#cb224-1"></a><span class="kw">with</span>(train_tmp, <span class="kw">CrossTable</span>(month, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##        month |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##          apr |     1800  |      342  |     2142  | 
##              |   10.489  |  102.274  |           | 
##              |   84.034% |   15.966% |    6.279% | 
##              |    5.818% |   10.778% |           | 
##              |    5.277% |    1.003% |           | 
## -------------|-----------|-----------|-----------|
##          aug |     4384  |      429  |     4813  | 
##              |    0.080  |    0.781  |           | 
##              |   91.087% |    8.913% |   14.110% | 
##              |   14.170% |   13.520% |           | 
##              |   12.852% |    1.258% |           | 
## -------------|-----------|-----------|-----------|
##          dec |       95  |       76  |      171  | 
##              |   23.284  |  227.031  |           | 
##              |   55.556% |   44.444% |    0.501% | 
##              |    0.307% |    2.395% |           | 
##              |    0.279% |    0.223% |           | 
## -------------|-----------|-----------|-----------|
##          feb |     1621  |      202  |     1823  | 
##              |    0.636  |    6.200  |           | 
##              |   88.919% |   11.081% |    5.344% | 
##              |    5.240% |    6.366% |           | 
##              |    4.752% |    0.592% |           | 
## -------------|-----------|-----------|-----------|
##          jan |      919  |       50  |      969  | 
##              |    1.833  |   17.872  |           | 
##              |   94.840% |    5.160% |    2.841% | 
##              |    2.970% |    1.576% |           | 
##              |    2.694% |    0.147% |           | 
## -------------|-----------|-----------|-----------|
##          jul |     4874  |      370  |     5244  | 
##              |    2.917  |   28.446  |           | 
##              |   92.944% |    7.056% |   15.373% | 
##              |   15.754% |   11.661% |           | 
##              |   14.289% |    1.085% |           | 
## -------------|-----------|-----------|-----------|
##          jun |     3766  |      359  |     4125  | 
##              |    0.163  |    1.591  |           | 
##              |   91.297% |    8.703% |   12.093% | 
##              |   12.173% |   11.314% |           | 
##              |   11.040% |    1.052% |           | 
## -------------|-----------|-----------|-----------|
##          mar |      113  |      101  |      214  | 
##              |   33.882  |  330.358  |           | 
##              |   52.804% |   47.196% |    0.627% | 
##              |    0.365% |    3.183% |           | 
##              |    0.331% |    0.296% |           | 
## -------------|-----------|-----------|-----------|
##          may |    10193  |      659  |    10852  | 
##              |   12.478  |  121.666  |           | 
##              |   93.927% |    6.073% |   31.814% | 
##              |   32.947% |   20.769% |           | 
##              |   29.882% |    1.932% |           | 
## -------------|-----------|-----------|-----------|
##          nov |     2821  |      292  |     3113  | 
##              |    0.002  |    0.020  |           | 
##              |   90.620% |    9.380% |    9.126% | 
##              |    9.118% |    9.203% |           | 
##              |    8.270% |    0.856% |           | 
## -------------|-----------|-----------|-----------|
##          oct |      224  |      195  |      419  | 
##              |   64.058  |  624.593  |           | 
##              |   53.461% |   46.539% |    1.228% | 
##              |    0.724% |    6.146% |           | 
##              |    0.657% |    0.572% |           | 
## -------------|-----------|-----------|-----------|
##          sep |      128  |       98  |      226  | 
##              |   28.908  |  281.867  |           | 
##              |   56.637% |   43.363% |    0.663% | 
##              |    0.414% |    3.089% |           | 
##              |    0.375% |    0.287% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="análisis-exploratorio-variables.html#cb226-1"></a><span class="kw">ggplot</span>(train_tmp, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según mes&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="análisis-exploratorio-variables.html#cb227-1"></a><span class="kw">ggplot</span>(train_tmp, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación de depósito según mes&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-89-2.png" width="672" /></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="análisis-exploratorio-variables.html#cb228-1"></a><span class="kw">ggplot</span>(train_tmp, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Contact&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación por mes&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-89-3.png" width="672" /></p>
<p>Podemos ver que hay meses en los que se producen más contrataciones que en otros.</p>
<p>Hallamos la regresión logística múltiple en función de la variable contact mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="análisis-exploratorio-variables.html#cb229-1"></a>train_tmp &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train_tmp, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;month&quot;</span>))</span>
<span id="cb229-2"><a href="análisis-exploratorio-variables.html#cb229-2"></a>modelo.log.m.month&lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>month, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train_tmp )</span>
<span id="cb229-3"><a href="análisis-exploratorio-variables.html#cb229-3"></a><span class="kw">summary</span>(modelo.log.m.month)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ month, family = binomial, 
##     data = train_tmp)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.1301  -0.4321  -0.3825  -0.3540   2.4348  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.66073    0.05899 -28.154  &lt; 2e-16 ***
## monthaug    -0.66353    0.07771  -8.539  &lt; 2e-16 ***
## monthdec     1.43759    0.16481   8.722  &lt; 2e-16 ***
## monthfeb    -0.42180    0.09512  -4.435 9.22e-06 ***
## monthjan    -1.25053    0.15674  -7.979 1.48e-15 ***
## monthjul    -0.91744    0.07992 -11.479  &lt; 2e-16 ***
## monthjun    -0.68972    0.08081  -8.535  &lt; 2e-16 ***
## monthmar     1.54846    0.14910  10.386  &lt; 2e-16 ***
## monthmay    -1.07800    0.07138 -15.102  &lt; 2e-16 ***
## monthnov    -0.60736    0.08520  -7.129 1.01e-12 ***
## monthoct     1.52208    0.11433  13.313  &lt; 2e-16 ***
## monthsep     1.39367    0.14662   9.506  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 19878  on 34099  degrees of freedom
## AIC: 19902
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y las variables dumis loan con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Obtenemos los intervalos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="análisis-exploratorio-variables.html#cb231-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.month, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) -1.7779012 -1.5465997
## monthaug    -0.8155806 -0.5108689
## monthdec     1.1127955  1.7598136
## monthfeb    -0.6094434 -0.2364103
## monthjan    -1.5685848 -0.9529045
## monthjul    -1.0740358 -0.7606395
## monthjun    -0.8481053 -0.5312162
## monthmar     1.2555833  1.8406766
## monthmay    -1.2171963 -0.9373090
## monthnov    -0.7747092 -0.4406086
## monthoct     1.2979819  1.7463688
## monthsep     1.1049574  1.6802911</code></pre>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan. Como el coeficiente asociado a la variable loan_yes es negativo, si el cliente tiene préstamo personal, tiene menos probabilidad de contratación.</p>
</div>
<div id="variable-day" class="section level3">
<h3><span class="header-section-number">2.4.11</span> Variable day</h3>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="análisis-exploratorio-variables.html#cb234-1"></a><span class="kw">describe</span>(train<span class="op">$</span>day)</span></code></pre></div>
<pre><code>## train$day 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       31    0.998    15.84    9.544        3        5 
##      .25      .50      .75      .90      .95 
##        8       16       21       28       30 
## 
## lowest :  1  2  3  4  5, highest: 27 28 29 30 31</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="análisis-exploratorio-variables.html#cb236-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> day)) <span class="op">+</span></span>
<span id="cb236-2"><a href="análisis-exploratorio-variables.html#cb236-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb236-3"><a href="análisis-exploratorio-variables.html#cb236-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Día del mes&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="análisis-exploratorio-variables.html#cb238-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>day, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Día del mes&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-93-2.png" width="672" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="análisis-exploratorio-variables.html#cb240-1"></a><span class="kw">ggplot</span>(train ,<span class="kw">aes</span>(<span class="dt">x=</span>day, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Día del mes&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-93-3.png" width="672" /></p>
<p>No se aprecia un patrón claro, salvo distintos picos que nos permite dividir la variable en tres partes.</p>
<p>La variable de forma continua no tiene interpretación clara. Por este motivo, se transforma la variable para ver si se encuentra alguna característica relevante en ella.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="análisis-exploratorio-variables.html#cb241-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">day_categorica =</span> <span class="kw">cut</span>(day, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">31</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;InicioMes&#39;</span>,<span class="st">&#39;MedioMes&#39;</span>,<span class="st">&#39;FinalMes&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="análisis-exploratorio-variables.html#cb242-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>day_categorica)</span></code></pre></div>
<pre><code>##  InicioMes MedioMes FinalMes
##                             
##      10310    14003     9798</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="análisis-exploratorio-variables.html#cb244-1"></a><span class="kw">describe</span>(train<span class="op">$</span>day_categorica)</span></code></pre></div>
<pre><code>## train$day_categorica 
##        n  missing distinct 
##    34111        0        3 
##                                         
## Value      InicioMes  MedioMes  FinalMes
## Frequency      10310     14003      9798
## Proportion     0.302     0.411     0.287</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="análisis-exploratorio-variables.html#cb246-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(day_categorica, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##                | term_deposit 
## day_categorica |       no  |      yes  | Row Total | 
## ---------------|-----------|-----------|-----------|
##      InicioMes |     9274  |     1036  |    10310  | 
##                |    0.633  |    6.177  |           | 
##                |   89.952% |   10.048% |   30.225% | 
##                |   29.976% |   32.650% |           | 
##                |   27.188% |    3.037% |           | 
## ---------------|-----------|-----------|-----------|
##       MedioMes |    12764  |     1239  |    14003  | 
##                |    0.318  |    3.101  |           | 
##                |   91.152% |    8.848% |   41.051% | 
##                |   41.257% |   39.048% |           | 
##                |   37.419% |    3.632% |           | 
## ---------------|-----------|-----------|-----------|
##       FinalMes |     8900  |      898  |     9798  | 
##                |    0.020  |    0.197  |           | 
##                |   90.835% |    9.165% |   28.724% | 
##                |   28.767% |   28.301% |           | 
##                |   26.091% |    2.633% |           | 
## ---------------|-----------|-----------|-----------|
##   Column Total |    30938  |     3173  |    34111  | 
##                |   90.698% |    9.302% |           | 
## ---------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="análisis-exploratorio-variables.html#cb248-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> day_categorica, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Día de contacto&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Día de contacto&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<p>Como podemos observar no existe un patrón claro a la hora de encontrar diferencias significativas en la probabilidad de contratar un depósito dependiendo del día del mes en el que se contactó con el cliente.</p>
<p>Únicamente existe una mayor probabilidad a la hora de contratar un depósito a principio de mes, pero sin diferencias significativas.</p>
</div>
<div id="variable-duration" class="section level3">
<h3><span class="header-section-number">2.4.12</span> Variable duration</h3>
<p>Es una variable cuantitativa que muestra la duración en segundos del último contacto mantenido con el cliente.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="análisis-exploratorio-variables.html#cb249-1"></a><span class="kw">describe</span>(train<span class="op">$</span>duration)</span></code></pre></div>
<pre><code>## train$duration 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0     1485        1    255.6      235       35       58 
##      .25      .50      .75      .90      .95 
##      100      176      315      544      749 
## 
## lowest :    0    2    3    4    5, highest: 3284 3322 3366 3881 4918</code></pre>
<p>Variable complicada ya que puede estar muy correlacionada con la variable dependiente.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="análisis-exploratorio-variables.html#cb251-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> duration)) <span class="op">+</span></span>
<span id="cb251-2"><a href="análisis-exploratorio-variables.html#cb251-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;Duracion contacto con el cliente&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="análisis-exploratorio-variables.html#cb253-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x=</span>duration, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Duracion contacto con el cliente&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-99-2.png" width="672" /></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="análisis-exploratorio-variables.html#cb255-1"></a><span class="kw">ggplot</span>(train ,<span class="kw">aes</span>(<span class="dt">x=</span>duration, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Duracion contacto con el cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-99-3.png" width="672" /></p>
<p>Se comprueba como el estar mayor tiempo de contacto con el cliente afecta positivamente a la probabilidad de contratar el depósito.</p>
<p>Se estudia las posibles transformaciones de la variable duration.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="análisis-exploratorio-variables.html#cb256-1"></a><span class="kw">symbox</span>(<span class="op">~</span>duration, <span class="dt">data =</span> train)</span></code></pre></div>
<pre><code>## Warning in symbox.default(as.vector(mf[[1]]), ylab = ylab, ...): start set to
## 49.18</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<p>Se transforma la variable mediante el logaritmo para suavizar el crecimiento al principio y acrecentarlo al final.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="análisis-exploratorio-variables.html#cb258-1"></a>duration_cero =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(duration <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb258-2"><a href="análisis-exploratorio-variables.html#cb258-2"></a><span class="kw">describe</span>(duration_cero<span class="op">$</span>duration)</span></code></pre></div>
<pre><code>## duration_cero$duration 
##        n  missing distinct     Info     Mean      Gmd 
##        3        0        1        0        0        0 
##             
## Value      0
## Frequency  3
## Proportion 1</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="análisis-exploratorio-variables.html#cb260-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">log_duration =</span> <span class="kw">log10</span>(duration))</span>
<span id="cb260-2"><a href="análisis-exploratorio-variables.html#cb260-2"></a></span>
<span id="cb260-3"><a href="análisis-exploratorio-variables.html#cb260-3"></a><span class="kw">describe</span>(train<span class="op">$</span>log_duration)</span></code></pre></div>
<pre><code>## Warning in w * sort(x - mean(x)): longitud de objeto mayor no es múltiplo de la
## longitud de uno menor</code></pre>
<pre><code>## train$log_duration 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0     1485        1     -Inf      NaN    1.544    1.763 
##      .25      .50      .75      .90      .95 
##    2.000    2.246    2.498    2.736    2.874 
## 
## lowest :      -Inf 0.3010300 0.4771213 0.6020600 0.6989700
## highest: 3.5164031 3.5213996 3.5271141 3.5889436 3.6917885</code></pre>
<p>Al aplicar logaritmo existen tres valores iguales a 0 que se deberían eliminar.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="análisis-exploratorio-variables.html#cb263-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> log_duration)) <span class="op">+</span></span>
<span id="cb263-2"><a href="análisis-exploratorio-variables.html#cb263-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;Log duracion contacto con el cliente&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 3 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="análisis-exploratorio-variables.html#cb266-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x=</span>log_duration, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Log duracion contacto con el cliente&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 3 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 3 rows containing non-finite values (stat_density).</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-102-2.png" width="672" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="análisis-exploratorio-variables.html#cb270-1"></a><span class="kw">ggplot</span>(train ,<span class="kw">aes</span>(log_duration, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Log duracion contacto con el cliente&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 3 rows containing non-finite values (stat_density).</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-102-3.png" width="672" /></p>
<p>Se aprecia como aquellas personas con mayor duración del contacto son las que tienen mayor probabilidad de contratar el depósito. Aunque es una variable muy correlacionada con la variable objetivo.</p>
</div>
<div id="variable-campaign" class="section level3">
<h3><span class="header-section-number">2.4.13</span> Variable campaign</h3>
<p>Es una variable cuantitativa que muestra el número de contactos en esta campaña hacia un cliente.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="análisis-exploratorio-variables.html#cb272-1"></a><span class="kw">describe</span>(train<span class="op">$</span>campaign)</span></code></pre></div>
<pre><code>## train$campaign 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       45    0.921     2.81    2.435        1        1 
##      .25      .50      .75      .90      .95 
##        1        2        3        5        8 
## 
## lowest :  1  2  3  4  5, highest: 43 44 55 58 63</code></pre>
<p>Se aprecia como la mediana, es decir el 50% de la población recibió dos contactos o menos. Así como solo un 10% de la población recibió más de 5 contactos.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="análisis-exploratorio-variables.html#cb274-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> campaign)) <span class="op">+</span></span>
<span id="cb274-2"><a href="análisis-exploratorio-variables.html#cb274-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb274-3"><a href="análisis-exploratorio-variables.html#cb274-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Nº de contactos con el cliente actual campaña&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="análisis-exploratorio-variables.html#cb276-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>campaign, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Nº de contactos con el cliente actual campaña&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-104-2.png" width="672" /></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="análisis-exploratorio-variables.html#cb278-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>campaign, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Nº de contactos con el cliente actual campaña&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-104-3.png" width="672" /></p>
<p>Se aprecia como aquellas personas con la que menos se ha contactado son las que más probabilidades tienen de contratar un depósito.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="análisis-exploratorio-variables.html#cb280-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(campaign, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##     campaign |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##            1 |    11473  |     1464  |    12937  | 
##              |    5.788  |   56.435  |           | 
##              |   88.684% |   11.316% |   37.926% | 
##              |   37.084% |   46.139% |           | 
##              |   33.634% |    4.292% |           | 
## -------------|-----------|-----------|-----------|
##            2 |     8679  |      855  |     9534  | 
##              |    0.117  |    1.144  |           | 
##              |   91.032% |    8.968% |   27.950% | 
##              |   28.053% |   26.946% |           | 
##              |   25.443% |    2.507% |           | 
## -------------|-----------|-----------|-----------|
##            3 |     3803  |      384  |     4187  | 
##              |    0.008  |    0.077  |           | 
##              |   90.829% |    9.171% |   12.275% | 
##              |   12.292% |   12.102% |           | 
##              |   11.149% |    1.126% |           | 
## -------------|-----------|-----------|-----------|
##            4 |     2452  |      208  |     2660  | 
##              |    0.645  |    6.284  |           | 
##              |   92.180% |    7.820% |    7.798% | 
##              |    7.926% |    6.555% |           | 
##              |    7.188% |    0.610% |           | 
## -------------|-----------|-----------|-----------|
##            5 |     1295  |       94  |     1389  | 
##              |    0.984  |    9.592  |           | 
##              |   93.233% |    6.767% |    4.072% | 
##              |    4.186% |    2.962% |           | 
##              |    3.796% |    0.276% |           | 
## -------------|-----------|-----------|-----------|
##            6 |      936  |       61  |      997  | 
##              |    1.114  |   10.863  |           | 
##              |   93.882% |    6.118% |    2.923% | 
##              |    3.025% |    1.922% |           | 
##              |    2.744% |    0.179% |           | 
## -------------|-----------|-----------|-----------|
##            7 |      541  |       34  |      575  | 
##              |    0.728  |    7.099  |           | 
##              |   94.087% |    5.913% |    1.686% | 
##              |    1.749% |    1.072% |           | 
##              |    1.586% |    0.100% |           | 
## -------------|-----------|-----------|-----------|
##            8 |      406  |       17  |      423  | 
##              |    1.302  |   12.692  |           | 
##              |   95.981% |    4.019% |    1.240% | 
##              |    1.312% |    0.536% |           | 
##              |    1.190% |    0.050% |           | 
## -------------|-----------|-----------|-----------|
##            9 |      234  |       14  |      248  | 
##              |    0.366  |    3.565  |           | 
##              |   94.355% |    5.645% |    0.727% | 
##              |    0.756% |    0.441% |           | 
##              |    0.686% |    0.041% |           | 
## -------------|-----------|-----------|-----------|
##           10 |      197  |        9  |      206  | 
##              |    0.553  |    5.389  |           | 
##              |   95.631% |    4.369% |    0.604% | 
##              |    0.637% |    0.284% |           | 
##              |    0.578% |    0.026% |           | 
## -------------|-----------|-----------|-----------|
##           11 |      156  |       11  |      167  | 
##              |    0.136  |    1.324  |           | 
##              |   93.413% |    6.587% |    0.490% | 
##              |    0.504% |    0.347% |           | 
##              |    0.457% |    0.032% |           | 
## -------------|-----------|-----------|-----------|
##           12 |      112  |        3  |      115  | 
##              |    0.568  |    5.539  |           | 
##              |   97.391% |    2.609% |    0.337% | 
##              |    0.362% |    0.095% |           | 
##              |    0.328% |    0.009% |           | 
## -------------|-----------|-----------|-----------|
##           13 |      101  |        5  |      106  | 
##              |    0.246  |    2.396  |           | 
##              |   95.283% |    4.717% |    0.311% | 
##              |    0.326% |    0.158% |           | 
##              |    0.296% |    0.015% |           | 
## -------------|-----------|-----------|-----------|
##           14 |       73  |        3  |       76  | 
##              |    0.240  |    2.343  |           | 
##              |   96.053% |    3.947% |    0.223% | 
##              |    0.236% |    0.095% |           | 
##              |    0.214% |    0.009% |           | 
## -------------|-----------|-----------|-----------|
##           15 |       69  |        4  |       73  | 
##              |    0.118  |    1.147  |           | 
##              |   94.521% |    5.479% |    0.214% | 
##              |    0.223% |    0.126% |           | 
##              |    0.202% |    0.012% |           | 
## -------------|-----------|-----------|-----------|
##           16 |       60  |        1  |       61  | 
##              |    0.395  |    3.850  |           | 
##              |   98.361% |    1.639% |    0.179% | 
##              |    0.194% |    0.032% |           | 
##              |    0.176% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           17 |       43  |        5  |       48  | 
##              |    0.007  |    0.064  |           | 
##              |   89.583% |   10.417% |    0.141% | 
##              |    0.139% |    0.158% |           | 
##              |    0.126% |    0.015% |           | 
## -------------|-----------|-----------|-----------|
##           18 |       39  |        0  |       39  | 
##              |    0.372  |    3.628  |           | 
##              |  100.000% |    0.000% |    0.114% | 
##              |    0.126% |    0.000% |           | 
##              |    0.114% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           19 |       41  |        0  |       41  | 
##              |    0.391  |    3.814  |           | 
##              |  100.000% |    0.000% |    0.120% | 
##              |    0.133% |    0.000% |           | 
##              |    0.120% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           20 |       38  |        0  |       38  | 
##              |    0.363  |    3.535  |           | 
##              |  100.000% |    0.000% |    0.111% | 
##              |    0.123% |    0.000% |           | 
##              |    0.111% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           21 |       29  |        0  |       29  | 
##              |    0.277  |    2.698  |           | 
##              |  100.000% |    0.000% |    0.085% | 
##              |    0.094% |    0.000% |           | 
##              |    0.085% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           22 |       15  |        0  |       15  | 
##              |    0.143  |    1.395  |           | 
##              |  100.000% |    0.000% |    0.044% | 
##              |    0.048% |    0.000% |           | 
##              |    0.044% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           23 |       18  |        0  |       18  | 
##              |    0.172  |    1.674  |           | 
##              |  100.000% |    0.000% |    0.053% | 
##              |    0.058% |    0.000% |           | 
##              |    0.053% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           24 |       14  |        0  |       14  | 
##              |    0.134  |    1.302  |           | 
##              |  100.000% |    0.000% |    0.041% | 
##              |    0.045% |    0.000% |           | 
##              |    0.041% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           25 |       17  |        0  |       17  | 
##              |    0.162  |    1.581  |           | 
##              |  100.000% |    0.000% |    0.050% | 
##              |    0.055% |    0.000% |           | 
##              |    0.050% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           26 |       12  |        0  |       12  | 
##              |    0.114  |    1.116  |           | 
##              |  100.000% |    0.000% |    0.035% | 
##              |    0.039% |    0.000% |           | 
##              |    0.035% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           27 |        9  |        0  |        9  | 
##              |    0.086  |    0.837  |           | 
##              |  100.000% |    0.000% |    0.026% | 
##              |    0.029% |    0.000% |           | 
##              |    0.026% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           28 |       11  |        0  |       11  | 
##              |    0.105  |    1.023  |           | 
##              |  100.000% |    0.000% |    0.032% | 
##              |    0.036% |    0.000% |           | 
##              |    0.032% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           29 |       13  |        1  |       14  | 
##              |    0.007  |    0.070  |           | 
##              |   92.857% |    7.143% |    0.041% | 
##              |    0.042% |    0.032% |           | 
##              |    0.038% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           30 |        7  |        0  |        7  | 
##              |    0.067  |    0.651  |           | 
##              |  100.000% |    0.000% |    0.021% | 
##              |    0.023% |    0.000% |           | 
##              |    0.021% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           31 |        7  |        0  |        7  | 
##              |    0.067  |    0.651  |           | 
##              |  100.000% |    0.000% |    0.021% | 
##              |    0.023% |    0.000% |           | 
##              |    0.021% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           32 |        7  |        0  |        7  | 
##              |    0.067  |    0.651  |           | 
##              |  100.000% |    0.000% |    0.021% | 
##              |    0.023% |    0.000% |           | 
##              |    0.021% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           33 |        6  |        0  |        6  | 
##              |    0.057  |    0.558  |           | 
##              |  100.000% |    0.000% |    0.018% | 
##              |    0.019% |    0.000% |           | 
##              |    0.018% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           34 |        5  |        0  |        5  | 
##              |    0.048  |    0.465  |           | 
##              |  100.000% |    0.000% |    0.015% | 
##              |    0.016% |    0.000% |           | 
##              |    0.015% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           35 |        3  |        0  |        3  | 
##              |    0.029  |    0.279  |           | 
##              |  100.000% |    0.000% |    0.009% | 
##              |    0.010% |    0.000% |           | 
##              |    0.009% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           36 |        4  |        0  |        4  | 
##              |    0.038  |    0.372  |           | 
##              |  100.000% |    0.000% |    0.012% | 
##              |    0.013% |    0.000% |           | 
##              |    0.012% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           37 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           38 |        3  |        0  |        3  | 
##              |    0.029  |    0.279  |           | 
##              |  100.000% |    0.000% |    0.009% | 
##              |    0.010% |    0.000% |           | 
##              |    0.009% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           39 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           41 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           43 |        3  |        0  |        3  | 
##              |    0.029  |    0.279  |           | 
##              |  100.000% |    0.000% |    0.009% | 
##              |    0.010% |    0.000% |           | 
##              |    0.009% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           44 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           55 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           58 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           63 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>Se realiza una tabla cruzada con la variable objetivo para ver ver más detalladamente la composición de la variable.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="análisis-exploratorio-variables.html#cb282-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> campaign, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Nº de contactos con el cliente&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Nº de contactos con el cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<p>Se comprueba como contactar solo una vez con el cliente tiene mayor probabilidad de contratar el depósito y esta va decreciendo conforme aumenta en una unidad el número de contactos con el cliente.</p>
<p>Posibles transformaciones.
Yo dejaría la variable tal y como está dado que un aumento en el número de contactos reduce la probabilidad de contratar el depósito. Aunque tendría en cuenta los outliers y los trataría.</p>
<p>Se realiza un logit con la variable objetivo para ver sus resultados.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="análisis-exploratorio-variables.html#cb283-1"></a>logit =<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>campaign, <span class="dt">family=</span>(<span class="kw">binomial</span>(<span class="dt">link=</span>logit)), <span class="dt">data =</span> train)</span>
<span id="cb283-2"><a href="análisis-exploratorio-variables.html#cb283-2"></a><span class="kw">summary</span>(logit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ campaign, family = (binomial(link = logit)), 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4778  -0.4778  -0.4533  -0.4077   3.2337  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.00137    0.02899  -69.03   &lt;2e-16 ***
## campaign    -0.11109    0.00987  -11.26   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 20940  on 34109  degrees of freedom
## AIC: 20944
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Tendríamos que sacar el efecto marginal para ver cuanto se reduce realmente la probabilidad de contratar el depósito. Aunque se puede ver que tiene efecto negativo y es significativa dicha variable</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="análisis-exploratorio-variables.html#cb285-1"></a> logitvec =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">dlogis</span>(<span class="kw">predict</span>(logit, <span class="dt">type =</span> <span class="st">&quot;link&quot;</span>)))</span>
<span id="cb285-2"><a href="análisis-exploratorio-variables.html#cb285-2"></a> logitvec <span class="op">*</span><span class="st"> </span><span class="kw">coef</span>(logit)</span></code></pre></div>
<pre><code>##  (Intercept)     campaign 
## -0.168141816 -0.009333048</code></pre>
<p>El efecto provoca que un aumento del contacto con el cliente en una unidad provoca que la probabilidad de contratar el depósito se reduzca en 0.0093.</p>
<p>Otras opciones sería realizar una variable categórica binaria a tal efecto.
Dividiéndose en haber tenido un contacto o más de un contacto lo cual reduce la probabilidad de contratar un depósito.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="análisis-exploratorio-variables.html#cb287-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">campaign_binaria =</span> <span class="kw">cut</span>(campaign, <span class="dt">breaks =</span>  <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">300</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;1Contacto&#39;</span>, <span class="st">&#39;+1Contacto&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="análisis-exploratorio-variables.html#cb288-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>campaign_binaria)</span></code></pre></div>
<pre><code>##  1Contacto +1Contacto
##                      
##      12937      21174</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="análisis-exploratorio-variables.html#cb290-1"></a><span class="kw">describe</span>(train<span class="op">$</span>campaign_binaria)</span></code></pre></div>
<pre><code>## train$campaign_binaria 
##        n  missing distinct 
##    34111        0        2 
##                                 
## Value       1Contacto +1Contacto
## Frequency       12937      21174
## Proportion      0.379      0.621</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="análisis-exploratorio-variables.html#cb292-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(campaign_binaria, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##                  | term_deposit 
## campaign_binaria |       no  |      yes  | Row Total | 
## -----------------|-----------|-----------|-----------|
##        1Contacto |    11473  |     1464  |    12937  | 
##                  |    5.788  |   56.435  |           | 
##                  |   88.684% |   11.316% |   37.926% | 
##                  |   37.084% |   46.139% |           | 
##                  |   33.634% |    4.292% |           | 
## -----------------|-----------|-----------|-----------|
##       +1Contacto |    19465  |     1709  |    21174  | 
##                  |    3.536  |   34.481  |           | 
##                  |   91.929% |    8.071% |   62.074% | 
##                  |   62.916% |   53.861% |           | 
##                  |   57.064% |    5.010% |           | 
## -----------------|-----------|-----------|-----------|
##     Column Total |    30938  |     3173  |    34111  | 
##                  |   90.698% |    9.302% |           | 
## -----------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="análisis-exploratorio-variables.html#cb294-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> campaign_binaria, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Nº de contactos con el cliente&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Nº de contactos con el cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p>Se aprecia como tener un solo contacto con el cliente aumenta su probabilidad de contratar al depósito al contrario ocurre cuando contactas con el cliente más de una vez.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="análisis-exploratorio-variables.html#cb295-1"></a>train<span class="op">$</span>campaign_binaria =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>campaign_binaria, <span class="dt">levels=</span>(<span class="kw">c</span>(<span class="st">&#39;+1Contacto&#39;</span>, <span class="st">&#39;1Contacto&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="análisis-exploratorio-variables.html#cb296-1"></a><span class="kw">levels</span>(train<span class="op">$</span>campaign_binaria)</span></code></pre></div>
<pre><code>## [1] &quot;+1Contacto&quot; &quot;1Contacto&quot;</code></pre>
<p>Estamos metiendo como variable de referencia a la variable que cuenta con mayor número de observaciones.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="análisis-exploratorio-variables.html#cb298-1"></a>logit_uno =<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>campaign_binaria, <span class="dt">family=</span>(<span class="kw">binomial</span>(<span class="dt">link=</span>logit)), <span class="dt">data =</span> train)</span>
<span id="cb298-2"><a href="análisis-exploratorio-variables.html#cb298-2"></a><span class="kw">summary</span>(logit_uno)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ campaign_binaria, family = (binomial(link = logit)), 
##     data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4901  -0.4901  -0.4103  -0.4103   2.2436  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -2.43271    0.02523 -96.424   &lt;2e-16 ***
## campaign_binaria1Contacto  0.37389    0.03751   9.969   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 21014  on 34109  degrees of freedom
## AIC: 21018
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Tener solo un contacto aumenta la probabilidad de contratar el depósito.</p>
</div>
<div id="variable-pdays" class="section level3">
<h3><span class="header-section-number">2.4.14</span> Variable pdays</h3>
<p>La variable pdays es una variable cuantitativa que muestra los días que han pasado desde que se contactó con él en la anterior campaña.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="análisis-exploratorio-variables.html#cb300-1"></a><span class="kw">describe</span>(train<span class="op">$</span>pdays)</span></code></pre></div>
<pre><code>## train$pdays 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0      409    0.393     34.1    62.25       -1       -1 
##      .25      .50      .75      .90      .95 
##       -1       -1       -1      175      301 
## 
## lowest :  -1   1   2   4   5, highest: 495 515 518 520 536</code></pre>
<p>Existen clientes con los que no se ha contactado en la campaña anterior.
En su gran mayoría no se ha contactado anteriormente con este cliente indicándose en la base de datos con valor -1.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="análisis-exploratorio-variables.html#cb302-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> pdays)) <span class="op">+</span></span>
<span id="cb302-2"><a href="análisis-exploratorio-variables.html#cb302-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb302-3"><a href="análisis-exploratorio-variables.html#cb302-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Número dias desde último contacto en campañas anteriores&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="análisis-exploratorio-variables.html#cb304-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>pdays, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número días desde último contacto en campañas anteriores&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-117-2.png" width="672" /></p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="análisis-exploratorio-variables.html#cb306-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>pdays, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número días desde último contacto en campañas anteriores&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-117-3.png" width="672" /></p>
<p>No se pueden apreciar ninguna característica adiccional en esta variable dado el gran peso que tiene no haber contactado anteriormente con el cliente en nuestra base de datos.</p>
<p>Para poder encontrar algún patrón que influya en la variable objetivo debemos mirar con mayor precisión. Por ello, evaluamos el 25% de los datos restantes para poder extraer una conclusión en base al número de días que pasaron desde que se contactó en la anterior campaña.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="análisis-exploratorio-variables.html#cb308-1"></a>pdays_pos =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pdays <span class="op">!=</span><span class="st"> </span><span class="dv">-1</span>)</span>
<span id="cb308-2"><a href="análisis-exploratorio-variables.html#cb308-2"></a><span class="kw">describe</span>(pdays_pos<span class="op">$</span>pdays)</span></code></pre></div>
<pre><code>## pdays_pos$pdays 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##     5230        0      408        1    227.9    119.5     79.0     93.0 
##      .25      .50      .75      .90      .95 
##    146.0    224.0    333.8    359.1    367.0 
## 
## lowest :   1   2   4   5   6, highest: 495 515 518 520 536</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="análisis-exploratorio-variables.html#cb310-1"></a><span class="kw">ggplot</span>(pdays_pos, <span class="kw">aes</span>(<span class="dt">x =</span> pdays, <span class="dt">colour =</span> term_deposit)) <span class="op">+</span></span>
<span id="cb310-2"><a href="análisis-exploratorio-variables.html#cb310-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb310-3"><a href="análisis-exploratorio-variables.html#cb310-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Número días desde último contacto en campañas anteriores&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="análisis-exploratorio-variables.html#cb312-1"></a><span class="kw">ggplot</span>(pdays_pos,<span class="kw">aes</span>(<span class="dt">x=</span>pdays, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número días desde último contacto en campañas anteriores&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-118-2.png" width="672" /></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="análisis-exploratorio-variables.html#cb314-1"></a><span class="kw">ggplot</span>(pdays_pos ,<span class="kw">aes</span>(<span class="dt">x=</span>pdays, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número días desde último contacto en campañas anteriores&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-118-3.png" width="672" /></p>
<p>Se puede apreciar como con aquellas personas que se contacta antes de los primeros 210 días (7 meses) existe una mayor proporción a la hora de contratar el depósito que respecto a las personas con las que se tarda en contactar mas tiempo respecto de la campaña anterior.</p>
<p>La mediana se encuentra en 224 días. Por ello, realizamos el corte dada la distribución y visualización de datos en una medida fácil de entender como son 7 meses = 210 días.</p>
<p>Para poder ver si esta variable es útil para nuestro objetivo, procedemos a crear una nueva variable categórica.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="análisis-exploratorio-variables.html#cb315-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">pdays_categorica =</span> <span class="kw">cut</span>(pdays, <span class="dt">breaks =</span>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">210</span>, <span class="dv">536</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;No contacto&#39;</span>, <span class="st">&#39;&lt;7 Meses&#39;</span>, <span class="st">&#39;&gt;7 Meses&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="análisis-exploratorio-variables.html#cb316-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>pdays_categorica)</span></code></pre></div>
<pre><code>##  No contacto &lt;7 Meses &gt;7 Meses
##                               
##        28881     2551     2679</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="análisis-exploratorio-variables.html#cb318-1"></a><span class="kw">describe</span>(train<span class="op">$</span>pdays_categorica)</span></code></pre></div>
<pre><code>## train$pdays_categorica 
##        n  missing distinct 
##    34111        0        3 
##                                               
## Value      No contacto    &lt;7 Meses    &gt;7 Meses
## Frequency        28881        2551        2679
## Proportion       0.847       0.075       0.079</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="análisis-exploratorio-variables.html#cb320-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(pdays_categorica, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##                  | term_deposit 
## pdays_categorica |       no  |      yes  | Row Total | 
## -----------------|-----------|-----------|-----------|
##      No contacto |    26509  |     2372  |    28881  | 
##                  |    3.776  |   36.819  |           | 
##                  |   91.787% |    8.213% |   84.668% | 
##                  |   85.684% |   74.756% |           | 
##                  |   77.714% |    6.954% |           | 
## -----------------|-----------|-----------|-----------|
##         &lt;7 Meses |     1985  |      566  |     2551  | 
##                  |   46.699  |  455.334  |           | 
##                  |   77.813% |   22.187% |    7.479% | 
##                  |    6.416% |   17.838% |           | 
##                  |    5.819% |    1.659% |           | 
## -----------------|-----------|-----------|-----------|
##         &gt;7 Meses |     2444  |      235  |     2679  | 
##                  |    0.083  |    0.809  |           | 
##                  |   91.228% |    8.772% |    7.854% | 
##                  |    7.900% |    7.406% |           | 
##                  |    7.165% |    0.689% |           | 
## -----------------|-----------|-----------|-----------|
##     Column Total |    30938  |     3173  |    34111  | 
##                  |   90.698% |    9.302% |           | 
## -----------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="análisis-exploratorio-variables.html#cb322-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> pdays_categorica, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Contacto desde anterior campaña&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Tiempo de contacto desde la anterior campaña&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<p>El gráfico muestra como aquellos con los que se volvió a contactar en menos de 7 meses desde la campaña anterior tienen mayor probabilidad de contratar el depósito que con los que se contactó después de esos 7 meses o incluso no se había contactado anteriormente.</p>
</div>
<div id="variable-poutcome" class="section level3">
<h3><span class="header-section-number">2.4.15</span> Variable poutcome</h3>
<p>La variable poutcome es una variable cualitativa polítoma que muestra el resultado de contratación de la última campaña con respecto a cada cliente. Los cuatro valores categóricos son: “failure”,“other”,“success” y “unknown”.</p>
<p>Resultado de la última campaña de márketin (failure, nonexistent, success).</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="análisis-exploratorio-variables.html#cb323-1"></a>train<span class="op">$</span>poutcome =<span class="st"> </span><span class="kw">factor</span> (train<span class="op">$</span>poutcome)</span>
<span id="cb323-2"><a href="análisis-exploratorio-variables.html#cb323-2"></a><span class="kw">levels</span>(train<span class="op">$</span>poutcome)</span></code></pre></div>
<pre><code>## [1] &quot;failure&quot; &quot;other&quot;   &quot;success&quot; &quot;unknown&quot;</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="análisis-exploratorio-variables.html#cb325-1"></a>reorder_reorder =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>reorder, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&#39;failure&#39;</span>,<span class="st">&#39;success&#39;</span>,<span class="st">&#39;unknown&#39;</span>,<span class="st">&#39;other&#39;</span>)))</span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `reorder`.</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="análisis-exploratorio-variables.html#cb327-1"></a><span class="kw">levels</span>(reorder_reorder)</span></code></pre></div>
<pre><code>## [1] &quot;failure&quot; &quot;success&quot; &quot;unknown&quot; &quot;other&quot;</code></pre>
<p>La variable poutcome es una variable cualitativa polítoma que muestra el resultado de contratación de la última campaña con respecto a cada cliente. Los cuatro valores categóricos son: “failure”,“other”,“success” y “unknown”</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="análisis-exploratorio-variables.html#cb329-1"></a>poutcome =<span class="st"> </span><span class="kw">factor</span>(train<span class="op">$</span>poutcome, <span class="dt">levels =</span> (<span class="kw">c</span>(<span class="st">&quot;failure&quot;</span>,<span class="st">&quot;other&quot;</span>,<span class="st">&quot;success&quot;</span>,<span class="st">&quot;unknown&quot;</span>)))</span></code></pre></div>
<p>Realizamos una tabla de frecuencias absoluta y de frecuencias relativa para ver su composición de forma univariante.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="análisis-exploratorio-variables.html#cb330-1"></a><span class="kw">ftable</span>(poutcome)</span></code></pre></div>
<pre><code>## poutcome failure other success unknown
##                                       
##             3401  1201     625   28884</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="análisis-exploratorio-variables.html#cb332-1"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(poutcome))</span></code></pre></div>
<pre><code>## poutcome    failure      other    success    unknown
##                                                     
##          0.09970391 0.03520858 0.01832254 0.84676497</code></pre>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="análisis-exploratorio-variables.html#cb334-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(poutcome)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> ), <span class="dt">fill =</span> <span class="st">&#39;skyblue2&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Resultado de la campaña anterior con el cliente&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<p>Si evaluamos la variable poutcome con respecto a nuestra variable objetivo (term_deposit).</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="análisis-exploratorio-variables.html#cb335-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(poutcome, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##     poutcome |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##      failure |     3074  |      327  |     3401  | 
##              |    0.037  |    0.358  |           | 
##              |   90.385% |    9.615% |    9.970% | 
##              |    9.936% |   10.306% |           | 
##              |    9.012% |    0.959% |           | 
## -------------|-----------|-----------|-----------|
##        other |     1052  |      149  |     1201  | 
##              |    1.276  |   12.442  |           | 
##              |   87.594% |   12.406% |    3.521% | 
##              |    3.400% |    4.696% |           | 
##              |    3.084% |    0.437% |           | 
## -------------|-----------|-----------|-----------|
##      success |      302  |      323  |      625  | 
##              |  123.755  | 1206.662  |           | 
##              |   48.320% |   51.680% |    1.832% | 
##              |    0.976% |   10.180% |           | 
##              |    0.885% |    0.947% |           | 
## -------------|-----------|-----------|-----------|
##      unknown |    26510  |     2374  |    28884  | 
##              |    3.735  |   36.413  |           | 
##              |   91.781% |    8.219% |   84.676% | 
##              |   85.688% |   74.819% |           | 
##              |   77.717% |    6.960% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>En la tabla de frecuencias observamos que el porcentaje de contratación es mucho mayor para aquellos clientes que aceptaron la campaña anterior, lo que indica que asegura la satisfacción de un buen número de clientes.</p>
<p>Gráficamente:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="análisis-exploratorio-variables.html#cb337-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> poutcome, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación depósito según resultado campaña anterior&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="análisis-exploratorio-variables.html#cb338-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> poutcome, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span> )) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación depósito resultado campaña anterior&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-128-2.png" width="672" /></p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="análisis-exploratorio-variables.html#cb339-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> poutcome, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;POutcome&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contratación según el resultado de la campaña anterior&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-128-3.png" width="672" /></p>
<p>Hallamos la regresión logística múltiple en función de la variable poutcome mediante las categorías dumificadas. Calculamos los parámetros de la regresión logística múltiple. No incluimos la categoría unknown en la regresión puesto que son valores faltantes y se desconoce su causa.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="análisis-exploratorio-variables.html#cb340-1"></a>train &lt;-<span class="st"> </span><span class="kw">dummy_cols</span> (train, <span class="dt">select_columns =</span> <span class="kw">c</span>(<span class="st">&quot;poutcome&quot;</span>))</span>
<span id="cb340-2"><a href="análisis-exploratorio-variables.html#cb340-2"></a>modelo.log.m.poutcome&lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">as.factor</span>(term_deposit) <span class="op">~</span><span class="st"> </span>poutcome_success <span class="op">+</span><span class="st"> </span>poutcome_other <span class="op">+</span><span class="st"> </span>poutcome_failure, <span class="dt">family =</span> binomial, <span class="dt">data =</span> train )</span>
<span id="cb340-3"><a href="análisis-exploratorio-variables.html#cb340-3"></a><span class="kw">summary</span>(modelo.log.m.poutcome)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(term_deposit) ~ poutcome_success + poutcome_other + 
##     poutcome_failure, family = binomial, data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.2061  -0.4142  -0.4142  -0.4142   2.2355  
## 
## Coefficients:
##                  Estimate Std. Error  z value Pr(&gt;|z|)    
## (Intercept)      -2.41295    0.02142 -112.633  &lt; 2e-16 ***
## poutcome_success  2.48017    0.08286   29.931  &lt; 2e-16 ***
## poutcome_other    0.45844    0.09012    5.087 3.63e-07 ***
## poutcome_failure  0.17217    0.06199    2.778  0.00548 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 21113  on 34110  degrees of freedom
## Residual deviance: 20331  on 34107  degrees of freedom
## AIC: 20339
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Obtenemos los intervalos de confianza de los coeficientes parciales de correlación del modelo. Los intervalos que contengan el 0 indican que la variable dummy a la que están asociados no es significativa en el modelo.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="análisis-exploratorio-variables.html#cb342-1"></a><span class="kw">confint</span>(<span class="dt">object =</span> modelo.log.m.poutcome, <span class="dt">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                        2.5 %     97.5 %
## (Intercept)      -2.45518218 -2.3712012
## poutcome_success  2.31783599  2.6427967
## poutcome_other    0.27822116  0.6317185
## poutcome_failure  0.04912664  0.2921867</code></pre>
<p>Los predictores estadísticamente significativos de la regresión son el intercept y todas las variables dumis poutcome_success, poutcome_other y poutcome_failure con pvalores menores que el nivel de significación impuesto (alfa = 0.05).</p>
<p>Los coeficientes positivos indican que aumenta la probabilidad de contrato del depósito para la categoría asociada y los negativos la decrementan. A mayor valor del coeficiente, mayor probabilidad. Destaca la categoría success que tiene un coeficiente mucho mayor que las otras, lo que indica que si en la anterior campaña hubo éxito, la probabilidad de contratación en esta es mucho mayor.</p>
</div>
<div id="variable-previous" class="section level3">
<h3><span class="header-section-number">2.4.16</span> Variable previous</h3>
<p>Variable cuantitativa que muestra el número de contactos que se realizaron al cliente en campañas anteriores.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="análisis-exploratorio-variables.html#cb345-1"></a><span class="kw">describe</span>(train<span class="op">$</span>previous)</span></code></pre></div>
<pre><code>## train$previous 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##    34111        0       36    0.393   0.4633   0.8488        0        0 
##      .25      .50      .75      .90      .95 
##        0        0        0        1        3 
## 
## lowest :   0   1   2   3   4, highest:  37  38  51  58 275</code></pre>
<p>Se aprecia como el 75% de los clientes no había sido contactado anteriormente al igual que en la variable pdays.</p>
<p>También notar que un 15% de los clientes únicamente había sido contactado 1 vez y sólo un 5% más de 3 veces.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="análisis-exploratorio-variables.html#cb347-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> previous)) <span class="op">+</span></span>
<span id="cb347-2"><a href="análisis-exploratorio-variables.html#cb347-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;skyblue2&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb347-3"><a href="análisis-exploratorio-variables.html#cb347-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Número de contactos en campañas anteriores&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="análisis-exploratorio-variables.html#cb349-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>previous, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número de contactos en campañas anteriores&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-132-2.png" width="672" /></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="análisis-exploratorio-variables.html#cb351-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(<span class="dt">x=</span>previous, <span class="dt">fill=</span>term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número de contactos en campañas anteriores&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-132-3.png" width="672" /></p>
<p>No se puede apreciar ninguna característica adiccional en esta variable dado el gran peso que tiene no haber tenido ningún contacto anteriormente con el cliente en campañas anteriores en la base de datos.</p>
<p>Para poder encontrar algún patrón que influya en la variable objetivo debemos mirar con mayor precisión. Se evalua el 25% de los datos restantes para poder extraer una conclusión en base al número de veces que se contactó con el cliente en campañas anteriores.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="análisis-exploratorio-variables.html#cb353-1"></a>previous_pos =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(previous <span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb353-2"><a href="análisis-exploratorio-variables.html#cb353-2"></a><span class="kw">describe</span>(previous_pos<span class="op">$</span>previous)</span></code></pre></div>
<pre><code>## previous_pos$previous 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##     5230        0       35     0.93    3.022    2.734        1        1 
##      .25      .50      .75      .90      .95 
##        1        2        3        6        8 
## 
## lowest :   1   2   3   4   5, highest:  37  38  51  58 275</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="análisis-exploratorio-variables.html#cb355-1"></a><span class="kw">ggplot</span>(previous_pos, <span class="kw">aes</span>(<span class="dt">x =</span> previous, <span class="dt">colour =</span> term_deposit)) <span class="op">+</span></span>
<span id="cb355-2"><a href="análisis-exploratorio-variables.html#cb355-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb355-3"><a href="análisis-exploratorio-variables.html#cb355-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Número de contactos en campañas anteriores&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="análisis-exploratorio-variables.html#cb357-1"></a><span class="kw">ggplot</span>(previous_pos,<span class="kw">aes</span>(<span class="dt">x=</span>previous, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número de contactos en campañas anteriores&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-133-2.png" width="672" /></p>
<p>Para toda la muestra obviando aquellos a los que no se contactó. El 95% tuvo menos de 8 contactos.</p>
<p>También se comprueba como a medida que va creciendo el número de contactos la probabilidad de contratar un depósito se reduce siendo ínfima cuando se supera el número de 10 contactos.</p>
<p>Analizando más al detalle obviando outliers. Se puede ver la composición de la variable</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="análisis-exploratorio-variables.html#cb358-1"></a>previous_pos =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(previous <span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>previous <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span>)</span>
<span id="cb358-2"><a href="análisis-exploratorio-variables.html#cb358-2"></a><span class="kw">describe</span>(previous_pos<span class="op">$</span>previous)</span></code></pre></div>
<pre><code>## previous_pos$previous 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##     5223        0       30     0.93    2.924    2.545        1        1 
##      .25      .50      .75      .90      .95 
##        1        2        3        6        8 
## 
## lowest :  1  2  3  4  5, highest: 26 27 28 29 30</code></pre>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="análisis-exploratorio-variables.html#cb360-1"></a><span class="kw">ggplot</span>(previous_pos, <span class="kw">aes</span>(<span class="dt">x =</span> previous, <span class="dt">colour =</span> term_deposit)) <span class="op">+</span></span>
<span id="cb360-2"><a href="análisis-exploratorio-variables.html#cb360-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb360-3"><a href="análisis-exploratorio-variables.html#cb360-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Número de contactos en campañas anteriores&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookDown_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="análisis-exploratorio-variables.html#cb362-1"></a><span class="kw">ggplot</span>(previous_pos,<span class="kw">aes</span>(<span class="dt">x=</span>previous, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>term_deposit) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Número de contactos en campañas anteriores&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-134-2.png" width="672" /></p>
<p>Por último, realizamos una tabla cruzada para ver más detalladamente la composición de la variable.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="análisis-exploratorio-variables.html#cb363-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(previous, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##              | term_deposit 
##     previous |       no  |      yes  | Row Total | 
## -------------|-----------|-----------|-----------|
##            0 |    26509  |     2372  |    28881  | 
##              |    3.776  |   36.819  |           | 
##              |   91.787% |    8.213% |   84.668% | 
##              |   85.684% |   74.756% |           | 
##              |   77.714% |    6.954% |           | 
## -------------|-----------|-----------|-----------|
##            1 |     1592  |      312  |     1904  | 
##              |   10.536  |  102.735  |           | 
##              |   83.613% |   16.387% |    5.582% | 
##              |    5.146% |    9.833% |           | 
##              |    4.667% |    0.915% |           | 
## -------------|-----------|-----------|-----------|
##            2 |     1188  |      197  |     1385  | 
##              |    3.699  |   36.069  |           | 
##              |   85.776% |   14.224% |    4.060% | 
##              |    3.840% |    6.209% |           | 
##              |    3.483% |    0.578% |           | 
## -------------|-----------|-----------|-----------|
##            3 |      569  |      110  |      679  | 
##              |    3.563  |   34.736  |           | 
##              |   83.800% |   16.200% |    1.991% | 
##              |    1.839% |    3.467% |           | 
##              |    1.668% |    0.322% |           | 
## -------------|-----------|-----------|-----------|
##            4 |      376  |       62  |      438  | 
##              |    1.137  |   11.091  |           | 
##              |   85.845% |   14.155% |    1.284% | 
##              |    1.215% |    1.954% |           | 
##              |    1.102% |    0.182% |           | 
## -------------|-----------|-----------|-----------|
##            5 |      207  |       48  |      255  | 
##              |    2.549  |   24.853  |           | 
##              |   81.176% |   18.824% |    0.748% | 
##              |    0.669% |    1.513% |           | 
##              |    0.607% |    0.141% |           | 
## -------------|-----------|-----------|-----------|
##            6 |      124  |       21  |      145  | 
##              |    0.429  |    4.184  |           | 
##              |   85.517% |   14.483% |    0.425% | 
##              |    0.401% |    0.662% |           | 
##              |    0.364% |    0.062% |           | 
## -------------|-----------|-----------|-----------|
##            7 |       90  |       14  |      104  | 
##              |    0.198  |    1.934  |           | 
##              |   86.538% |   13.462% |    0.305% | 
##              |    0.291% |    0.441% |           | 
##              |    0.264% |    0.041% |           | 
## -------------|-----------|-----------|-----------|
##            8 |       56  |       12  |       68  | 
##              |    0.522  |    5.091  |           | 
##              |   82.353% |   17.647% |    0.199% | 
##              |    0.181% |    0.378% |           | 
##              |    0.164% |    0.035% |           | 
## -------------|-----------|-----------|-----------|
##            9 |       36  |        6  |       42  | 
##              |    0.115  |    1.121  |           | 
##              |   85.714% |   14.286% |    0.123% | 
##              |    0.116% |    0.189% |           | 
##              |    0.106% |    0.018% |           | 
## -------------|-----------|-----------|-----------|
##           10 |       29  |        3  |       32  | 
##              |    0.000  |    0.000  |           | 
##              |   90.625% |    9.375% |    0.094% | 
##              |    0.094% |    0.095% |           | 
##              |    0.085% |    0.009% |           | 
## -------------|-----------|-----------|-----------|
##           11 |       35  |        3  |       38  | 
##              |    0.008  |    0.081  |           | 
##              |   92.105% |    7.895% |    0.111% | 
##              |    0.113% |    0.095% |           | 
##              |    0.103% |    0.009% |           | 
## -------------|-----------|-----------|-----------|
##           12 |       24  |        2  |       26  | 
##              |    0.007  |    0.072  |           | 
##              |   92.308% |    7.692% |    0.076% | 
##              |    0.078% |    0.063% |           | 
##              |    0.070% |    0.006% |           | 
## -------------|-----------|-----------|-----------|
##           13 |       19  |        2  |       21  | 
##              |    0.000  |    0.001  |           | 
##              |   90.476% |    9.524% |    0.062% | 
##              |    0.061% |    0.063% |           | 
##              |    0.056% |    0.006% |           | 
## -------------|-----------|-----------|-----------|
##           14 |        9  |        1  |       10  | 
##              |    0.001  |    0.005  |           | 
##              |   90.000% |   10.000% |    0.029% | 
##              |    0.029% |    0.032% |           | 
##              |    0.026% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           15 |       12  |        0  |       12  | 
##              |    0.114  |    1.116  |           | 
##              |  100.000% |    0.000% |    0.035% | 
##              |    0.039% |    0.000% |           | 
##              |    0.035% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           16 |        8  |        0  |        8  | 
##              |    0.076  |    0.744  |           | 
##              |  100.000% |    0.000% |    0.023% | 
##              |    0.026% |    0.000% |           | 
##              |    0.023% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           17 |        7  |        2  |        9  | 
##              |    0.166  |    1.615  |           | 
##              |   77.778% |   22.222% |    0.026% | 
##              |    0.023% |    0.063% |           | 
##              |    0.021% |    0.006% |           | 
## -------------|-----------|-----------|-----------|
##           18 |        5  |        0  |        5  | 
##              |    0.048  |    0.465  |           | 
##              |  100.000% |    0.000% |    0.015% | 
##              |    0.016% |    0.000% |           | 
##              |    0.015% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           19 |        6  |        0  |        6  | 
##              |    0.057  |    0.558  |           | 
##              |  100.000% |    0.000% |    0.018% | 
##              |    0.019% |    0.000% |           | 
##              |    0.018% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           20 |        3  |        0  |        3  | 
##              |    0.029  |    0.279  |           | 
##              |  100.000% |    0.000% |    0.009% | 
##              |    0.010% |    0.000% |           | 
##              |    0.009% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           21 |        2  |        1  |        3  | 
##              |    0.191  |    1.863  |           | 
##              |   66.667% |   33.333% |    0.009% | 
##              |    0.006% |    0.032% |           | 
##              |    0.006% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           22 |        4  |        1  |        5  | 
##              |    0.063  |    0.615  |           | 
##              |   80.000% |   20.000% |    0.015% | 
##              |    0.013% |    0.032% |           | 
##              |    0.012% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           23 |        4  |        0  |        4  | 
##              |    0.038  |    0.372  |           | 
##              |  100.000% |    0.000% |    0.012% | 
##              |    0.013% |    0.000% |           | 
##              |    0.012% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           24 |        5  |        0  |        5  | 
##              |    0.048  |    0.465  |           | 
##              |  100.000% |    0.000% |    0.015% | 
##              |    0.016% |    0.000% |           | 
##              |    0.015% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           25 |        3  |        0  |        3  | 
##              |    0.029  |    0.279  |           | 
##              |  100.000% |    0.000% |    0.009% | 
##              |    0.010% |    0.000% |           | 
##              |    0.009% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           26 |        1  |        1  |        2  | 
##              |    0.365  |    3.561  |           | 
##              |   50.000% |   50.000% |    0.006% | 
##              |    0.003% |    0.032% |           | 
##              |    0.003% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           27 |        4  |        0  |        4  | 
##              |    0.038  |    0.372  |           | 
##              |  100.000% |    0.000% |    0.012% | 
##              |    0.013% |    0.000% |           | 
##              |    0.012% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           28 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           29 |        3  |        1  |        4  | 
##              |    0.109  |    1.060  |           | 
##              |   75.000% |   25.000% |    0.012% | 
##              |    0.010% |    0.032% |           | 
##              |    0.009% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           30 |        1  |        1  |        2  | 
##              |    0.365  |    3.561  |           | 
##              |   50.000% |   50.000% |    0.006% | 
##              |    0.003% |    0.032% |           | 
##              |    0.003% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##           37 |        2  |        0  |        2  | 
##              |    0.019  |    0.186  |           | 
##              |  100.000% |    0.000% |    0.006% | 
##              |    0.006% |    0.000% |           | 
##              |    0.006% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           38 |        2  |        0  |        2  | 
##              |    0.019  |    0.186  |           | 
##              |  100.000% |    0.000% |    0.006% | 
##              |    0.006% |    0.000% |           | 
##              |    0.006% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           51 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
##           58 |        0  |        1  |        1  | 
##              |    0.907  |    8.843  |           | 
##              |    0.000% |  100.000% |    0.003% | 
##              |    0.000% |    0.032% |           | 
##              |    0.000% |    0.003% |           | 
## -------------|-----------|-----------|-----------|
##          275 |        1  |        0  |        1  | 
##              |    0.010  |    0.093  |           | 
##              |  100.000% |    0.000% |    0.003% | 
##              |    0.003% |    0.000% |           | 
##              |    0.003% |    0.000% |           | 
## -------------|-----------|-----------|-----------|
## Column Total |    30938  |     3173  |    34111  | 
##              |   90.698% |    9.302% |           | 
## -------------|-----------|-----------|-----------|
## 
## </code></pre>
<p>Una vez analizada mediante esta tabla lo más razonable sería realizar una transformación de la variable cuantitativa en una variable binaria dependiendo de si se ha contactado anteriormente o no con el cliente.</p>
<p>En torno al 85% de los clientes no habían sido contactados previamente.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="análisis-exploratorio-variables.html#cb365-1"></a>train =<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">previous_categorica =</span> <span class="kw">cut</span>(previous, <span class="dt">breaks =</span>  <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">300</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Sin Contacto previo&#39;</span>, <span class="st">&#39;Contacto previo&#39;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="análisis-exploratorio-variables.html#cb366-1"></a><span class="kw">ftable</span>(train<span class="op">$</span>previous_categorica)</span></code></pre></div>
<pre><code>##  Sin Contacto previo Contacto previo
##                                     
##                28881            5230</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="análisis-exploratorio-variables.html#cb368-1"></a><span class="kw">describe</span>(train<span class="op">$</span>previous_categorica)</span></code></pre></div>
<pre><code>## train$previous_categorica 
##        n  missing distinct 
##    34111        0        2 
##                                                   
## Value      Sin Contacto previo     Contacto previo
## Frequency                28881                5230
## Proportion               0.847               0.153</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="análisis-exploratorio-variables.html#cb370-1"></a><span class="kw">with</span>(train, <span class="kw">CrossTable</span>(previous_categorica, term_deposit, <span class="dt">format =</span> <span class="st">&#39;SPSS&#39;</span>))</span></code></pre></div>
<pre><code>## 
##    Cell Contents
## |-------------------------|
## |                   Count |
## | Chi-square contribution |
## |             Row Percent |
## |          Column Percent |
## |           Total Percent |
## |-------------------------|
## 
## Total Observations in Table:  34111 
## 
##                     | term_deposit 
## previous_categorica |       no  |      yes  | Row Total | 
## --------------------|-----------|-----------|-----------|
## Sin Contacto previo |    26509  |     2372  |    28881  | 
##                     |    3.776  |   36.819  |           | 
##                     |   91.787% |    8.213% |   84.668% | 
##                     |   85.684% |   74.756% |           | 
##                     |   77.714% |    6.954% |           | 
## --------------------|-----------|-----------|-----------|
##     Contacto previo |     4429  |      801  |     5230  | 
##                     |   20.853  |  203.320  |           | 
##                     |   84.685% |   15.315% |   15.332% | 
##                     |   14.316% |   25.244% |           | 
##                     |   12.984% |    2.348% |           | 
## --------------------|-----------|-----------|-----------|
##        Column Total |    30938  |     3173  |    34111  | 
##                     |   90.698% |    9.302% |           | 
## --------------------|-----------|-----------|-----------|
## 
## </code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="análisis-exploratorio-variables.html#cb372-1"></a><span class="kw">ggplot</span>(train, <span class="kw">aes</span>(<span class="dt">x =</span> previous_categorica, <span class="dt">fill =</span> term_deposit)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span> <span class="kw">position_fill</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Contacto en campaña anterior&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;prop&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contacto en la anterior campaña&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>El gráfico muestra como aquellos con los que se contactó previamente tienen mayor probabilidad de contratar un depósito que aquellos con los que no se había contactado en la campaña anterior.</p>
<p>Variable muy relacionada con pdays ya que determina el número de días que pasó desde que se contactó con el cliente en la campaña mientras que pdays determina el número de días que pasaron desde que se contactó en campañas anteriores con el cliente.</p>
<p>Si se introduce una de las dos variables no se debe introducir la otra por problemas de multicolinealidad.</p>
</div>
<div id="variable-term_deposit-objetivo" class="section level3">
<h3><span class="header-section-number">2.4.17</span> Variable term_deposit (Objetivo)</h3>
<p>La variable term_deposit (variable binaria) indica si el cliente suscribe el depósito (“sí”,“no”)</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="análisis-exploratorio-variables.html#cb373-1"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(train<span class="op">$</span>term_deposit))</span></code></pre></div>
<pre><code>## 
##         no        yes 
## 0.90698015 0.09301985</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="análisis-exploratorio-variables.html#cb375-1"></a><span class="kw">ggplot</span>(train,<span class="kw">aes</span>(term_deposit))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">fill=</span><span class="st">&quot;green&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;Se suscribe el cliente?&quot;</span>)</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="exploratorio-multivariante" class="section level2">
<h2><span class="header-section-number">2.5</span> Exploratorio multivariante</h2>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="análisis-exploratorio-variables.html#cb376-1"></a><span class="kw">pairs</span>( age <span class="op">~</span><span class="st"> </span>duration <span class="op">+</span><span class="st"> </span>campaign <span class="op">+</span><span class="st"> </span>previous, <span class="dt">data=</span>train, <span class="dt">main=</span><span class="st">&quot;Gráfico - Matriz de dispersión&quot;)</span></span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="análisis-exploratorio-variables.html#cb377-1"></a><span class="kw">library</span>(corrplot)</span>
<span id="cb377-2"><a href="análisis-exploratorio-variables.html#cb377-2"></a>train <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(age,balance,day, duration, campaign, pdays, previous) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>( <span class="dt">method =</span><span class="st">&quot;spearman&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">corrplot</span>()</span></code></pre></div>
<p><img src="bookDown_files/figure-html/unnamed-chunk-141-2.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introducción-y-objetivos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="etl.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
